[["index.html", "Lab 4 - Hypothesis testing for proportion, goodness-of-fit, and categorical data analysis 1 Welcome to Lab 4 1.1 A summary of the type of the hypothesis test and R commands used today", " Lab 4 - Hypothesis testing for proportion, goodness-of-fit, and categorical data analysis 1 Welcome to Lab 4 Intended Learning Outcomes: Conduct a hypothesis test for the population proportion in R with a step-by-step guide. Conduct a goodness-of-fit test in R with a step-by-step guide. Conduct hypothesis test of independence or homogeneity in R with a step-by-step guide. 1.1 A summary of the type of the hypothesis test and R commands used today Test for population proportions The exact Binomial test can be implemented in R by using binom.test: binom.test(x, n, p = 0.5, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;), conf.level = 0.95) x: number of successes n: number of trials p: hypothesized probability of success, i.e. \\(\\pi\\) under \\(H_0\\) alternative and conf.level: same as explained in the var.test function. Testing the proportion of successes in a Binomial experiment with normal approximation can be performed by using prop.test: prop.test(x, n, p = NULL, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;), conf.level = 0.95, correct = TRUE) All arguments are the same as in the binom.test() function. Goodness-of-fit test The test criterion for testing \\(H_0: F_X(x) = F_0(x)\\) for all \\(x\\) against the alternative \\(H_1: F_X(x) \\neq F_0(x)\\) for some \\(x\\) when the null hypothesis is completely specified is \\[\\chi^2_\\text{obs} = \\sum_{k=1}^K \\frac{(O_k-E_k)^2}{E_k},\\] where \\(K\\) is the total number of categories. For large \\(n\\), provided all expected categories are at least 5, \\(\\chi^2_\\text{obs}\\) is distributed approximately \\(\\chi^2_{K-1}\\). The test can be performed by using chisq.test: chisq.test(x, p) x: a vector of observed counts in each category p: a vector of probabilities for the observations falling into each category Test of independence and test of homogeneity The test criterion for test of independence, i.e. \\(H_0: F_X(x) = F_0(x)\\) for all \\(x\\) vs \\(H_1: F_X(x) \\neq F_0(x)\\) for some \\(x\\), and the test criterion for test of homogeneity, i.e., when the null hypothesis is completely specified is \\[\\chi^2_\\text{obs} = \\sum_{i=1}^I\\sum_{j=1}^J \\frac{(O_{ij}-E_{ij})^2}{E_{ij}},\\] where \\(I\\) is the total number of rows and \\(J\\) is the total number of columns. As the test criterion has the same form as the goodness-of-fit test, the same R command can be used to perform the test: chisq.test(data), where data is the \\(I \\times J\\) contingency table collected from the experiment. "],["example-1-dependent-children.html", "2 Example 1: Dependent children 2.1 Step 0: construct the observed and expected values for different categories 2.2 Step 1 - Hypotheses 2.3 Step 2 - Choosing a Test Statistic 2.4 Step 3 - Rejection Region Calculations 2.5 Step 4 - Statistical Conclusion 2.6 Step 5 - English Conclusion", " 2 Example 1: Dependent children The data frame DEPEND from the PASWR2 package shows the number of dependent children (number) for 50 families (count). Use a goodness-of-fit test to see if a Poisson distribution with \\(\\lambda\\) = 2 can reasonably be used to model the number of dependent children. The significance level is 5%. 2.1 Step 0: construct the observed and expected values for different categories To start with, we look at the data to determine how many categories should be created. FT &lt;- xtabs(~number, data = DEPEND) FT ## number ## 0 1 2 3 4 5 6 ## 9 13 13 7 4 3 1 Based on the frequency table for the number of dependent children, the cells with four, five, and six children are combined into a single cell for four or more children. After the merge, we get the observed number of children for five categories as follows: obs &lt;- c(9, 13, 13, 7, 8) Under the null hypothesis that \\(F_0(x)\\) is a Poisson distribution with \\(\\lambda=2\\), the probabilities of 0, 1, 2, 3, and 4 or more dependent children are computed with R as follows: null.p &lt;- c(dpois(0, 2), dpois(1, 2), dpois(2, 2), dpois(3, 2), ppois(3, 2, lower = FALSE)) null.p ## [1] 0.1353353 0.2706706 0.2706706 0.1804470 0.1428765 Since there were a total of \\(n = 50\\) families, the expected number of dependent children for the five categories is simply \\(50 \\times\\)null.p. EX &lt;- 50*null.p EX ## [1] 6.766764 13.533528 13.533528 9.022352 7.143827 We are now ready to conduct the hypothesis test. 2.2 Step 1 - Hypotheses The null and alternative hypotheses for using the chi-square goodness-of-fit test to test the hypothesis that the number of dependent children follows a Poisson distribution with \\(\\lambda = 2\\) are: \\[ \\begin{split} &amp;H_0: F_X(x) = F_0(x) \\sim Pois(\\lambda = 2.5) \\text{ for all } x \\textit{ versus}\\\\ &amp;H_1: F_X(x) \\neq F_0(x) \\text{ for some }x. \\end{split}\\] 2.3 Step 2 - Choosing a Test Statistic The test statistic chosen is \\(\\chi^2_\\text{obs} = \\sum_{k=1}^5 \\frac{(O_k-E_k)^2}{E_k}\\). 2.4 Step 3 - Rejection Region Calculations Reject \\(H_0\\) if \\(\\chi^2_\\text{obs} &gt; \\chi^2_{1-\\alpha;K-1}\\), where \\(K\\) denotes the number of categories. QUESTION: Find the value of the test statistic. \\(\\chi^2_\\text{obs}\\)= Find the critical value. \\(\\chi^2_{1-\\alpha;k-1}\\)= Find the \\(p\\)-value. \\(p\\)-value= Solution Using R, we can find the value of test statistic, the critical value, and \\(p\\)-value (\\(P(\\chi^2_4 \\geq \\chi^2_\\text{obs})\\)) as follows. chi.obs &lt;- sum((obs - EX)^2/EX) #value of the test statistic chi.obs ## [1] 1.33502 qchisq(0.95, 4) #critical value ## [1] 9.487729 pchisq(chi.obs, 4, lower=FALSE) #p-value ## [1] 0.8554064 chisq.test(x=obs, p=null.p) ## ## Chi-squared test for given probabilities ## ## data: obs ## X-squared = 1.335, df = 4, p-value = 0.8554 We can find the value of test statistic and \\(p\\)-value by using the R function chisq.test. chisq.test(x=obs, p=null.p) ## ## Chi-squared test for given probabilities ## ## data: obs ## X-squared = 1.335, df = 4, p-value = 0.8554 In the output, X-squared gives the value of test statistic, df is the degrees of freedom for this \\(\\chi^2\\) distribution, and p-value gives the \\(p\\)-value. 2.5 Step 4 - Statistical Conclusion Do we reject the null hypothesis? Yes No Solution I. Since \\(\\chi^2_\\text{obs}=1.335\\) is not greater than \\(\\chi^2_{0.95;4}= 9.4877\\), fail to reject \\(H_0\\). OR Since \\(p\\)-value\\(=0.8554 &gt; 0.05\\), fail to reject \\(H_0\\). 2.6 Step 5 - English Conclusion Which of the following is the correct conclusion of our test? There is evidence to suggest that the true cdf equals the Poisson distribution with \\(\\lambda = 2\\) for all \\(x\\). There is evidence to suggest that the true cdf equals the Poisson distribution with \\(\\lambda = 2\\) for at least one \\(x\\). There is no evidence to suggest that the true cdf does not equal the Poisson distribution with \\(\\lambda = 2\\) for at least one \\(x\\). There is no evidence to suggest that the true cdf does not equal the Poisson distribution with \\(\\lambda = 2\\) for all \\(x\\). 1234 "],["exercise-1-vitoria-apartment-elevators.html", "3 Exercise 1: Vitoria Apartment Elevators 3.1 Question 1 3.2 Question 2", " 3 Exercise 1: Vitoria Apartment Elevators In this exercise, we continue studying the Victoria apartment dataset from Lab 3 but investigate a different question about the number of elevators in apartments. The director of urban housing in Vitoria, Spain, claims that over 75% of all apartments have an elevator. Using the variable elevator from the dataframe VIT2005 in the package PASWR2, answer the questions below: 1. Can the director’s claim about elevators be substantiated using an exact method to reach a conclusion? 2. Can the director’s claim about elevators be substantiated using an approximate method to reach a conclusion? Is this test in agreement with the exact method test above? Use a 10% significance level for all tests. 3.1 Question 1 3.1.1 Step 1 - Hypotheses For this question, we will complete an exact test for testing the proportion of successes in a Binomial distribution. Let \\(\\pi\\) denote the probability that an apartment has an elevator. Which of the following gives the correct null and alternative hypotheses? \\(H_0: \\pi=0.75 \\text{ versus } H_1: \\pi\\neq 0.75\\) \\(H_0: \\pi=0.75 \\text{ versus } H_1: \\pi&lt; 0.75\\) \\(H_0: \\pi=0.75 \\text{ versus } H_1: \\pi&gt; 0.75\\) \\(H_0: \\pi&gt;0.75 \\text{ versus } H_1: \\pi\\leq 0.75\\) 1234 3.1.2 Step 2 - Choosing a Test Statistic The test statistic is \\(Y\\), where \\(Y\\) is the number of apartments that have an elevator. Under the assumption that \\(H_0\\) is true, \\(Y \\sim Bin(n,\\pi) = Bin(218,0.75)\\). What is the observed value of the test statistic? \\(y_\\text{obs}=\\) Solution The value of the test statistic is simply the number of apartments that have an elevator in this data set. This can be found by using the following commands. table(VIT2005$elevator) ## ## 0 1 ## 44 174 #or xtabs(~elevator, data = VIT2005) ## elevator ## 0 1 ## 44 174 3.1.3 Step 3 - Finding the \\(p\\)-value For a binomial hypothesis test we can calculate a \\(p\\)-value straight from our test statistic and compare it with the significance level. (Typically we will not find the rejection region nor standardise the test statistic.) What is the \\(p\\)-value in this case? \\(p\\)-value\\(=\\) Hint For an upper-tail one-sided test, \\(p\\)-value is the probability of seeing the value of test statistic or even more extreme values under the assumption that \\(H_0\\) is true, i.e. \\(p\\text{-value} = P(Y\\geq y_{obs}|H_0) = P(Y \\geq 174|Y \\sim Bin(218,0.75)\\). The \\(p\\)-value can also be calculated by using the R function binom.test. Solution As mentioned in the hint, \\(p\\)-value can be calculated as follows: \\[ \\begin{align} p\\text{-value} = P(Y\\geq y_{obs}|H_0)&amp;=\\sum^{n}_{i=y_{obs}} {n \\choose i} \\pi^i_0 (1-\\pi_0)^{n-i}\\\\ &amp;=\\sum^{218}_{174} {218 \\choose i} 0.75^i (0.25)^{218-i}\\\\ &amp;= 0.0564\\\\ &amp;\\text{(Using R as a calculator to compute)} \\end{align} \\] yobs &lt;- as.numeric(table(VIT2005$elevator)[2]) n &lt;- nrow(VIT2005) pvalue &lt;- sum(dbinom(yobs:n, n, 0.75)) pvalue ## [1] 0.05643458 Or we can get the \\(p\\)-value by using the built-in function: binom.test(x = yobs, n = n, p = 0.75, alternative = &quot;greater&quot;) ## ## Exact binomial test ## ## data: yobs and n ## number of successes = 174, number of trials = 218, p-value = 0.05643 ## alternative hypothesis: true probability of success is greater than 0.75 ## 95 percent confidence interval: ## 0.748218 1.000000 ## sample estimates: ## probability of success ## 0.7981651 3.1.4 Step 4 &amp; 5 - Statistical and English Conclusion What is the conclusion of the test? Since p-value is greater than 0.05, we fail to reject the null hypothesis and conclude that there is not sufficient evidence to substantiate the claim that over 75% of all apartments have an elevator. Since p-value is greater than 0.05, we reject the null hypothesis and conclude that there is sufficient evidence to substantiate the claim that over 75% of all apartments have an elevator. Since p-value is less than 0.1, we reject the null hypothesis and conclude that there is evidence to substantiate the claim that over 75% of all apartments have an elevator. Since p-value is less than 0.1, we fail to reject the null hypothesis and conclude that there is not sufficient evidence to substantiate the claim that over 75% of all apartments have an elevator. 3.2 Question 2 3.2.1 Step 1 - Hypotheses For this question, we will complete a one-sample approximate hypothesis test using a normal distribution. In other words, we will approximate the Binomial random variable \\(Y\\) with an appropriate normal distribution. The null and alternative hypotheses to substantiate the housing director’s claim about the elevators are still: \\[H_0 : \\pi = 0.75 \\quad \\text{versus} \\quad H_1 : \\pi &gt; 0.75.\\] 3.2.2 Step 2 - Choosing a Test Statistic Let \\(P\\) denote the test statistic, where \\(P\\) is the population proportion of apartments that have an elevator. Provided \\(H_0\\) is true, what is the approximated distribution of \\(P\\)? In other words, what are the mean \\(\\mu\\) and variance \\(\\sigma^2\\) for this normal approximation \\(N(\\mu,\\sigma^2)\\)? \\(\\pi_0\\) below denotes the hypothesised probability of success under \\(H_0\\). \\(P \\dot{\\sim} N\\left(\\pi_0, \\pi_0(1-\\pi_0)\\right)\\) \\(P \\dot{\\sim} N\\left(\\pi_0, \\frac{\\pi_0(1-\\pi_0)}{n}\\right)\\) \\(P \\dot{\\sim} N\\left(\\pi_0, \\sqrt{\\frac{\\pi_0(1-\\pi_0)}{n}}\\right)\\) \\(P \\dot{\\sim} N\\left(\\pi_0, \\frac{\\pi_0(1-\\pi_0)}{n-1}\\right)\\) 1234 Provided \\(H_0\\) is true, what is the approximated distribution of the standardised test statistic \\(Z\\)? \\(Z=\\frac{P-\\pi_0}{\\sqrt{\\pi_0(1-\\pi_0)}} \\dot{\\sim} N\\left(0, 1\\right)\\) \\(Z= \\frac{P-\\pi_0}{\\frac{\\pi_0(1-\\pi_0)}{n}} \\dot{\\sim} N\\left(0, 1\\right)\\) \\(Z= \\frac{P-\\pi_0}{\\sqrt{\\frac{\\pi_0(1-\\pi_0)}{n}}} \\dot{\\sim} N\\left(0, 1\\right)\\) 123 3.2.3 Step 3 - Hypothesis Test Calculations One approach to performing a hypothesis test is to compare the value of standardised test statistic and the rejection region. What is the value of the standardised test statistic with continuity correction, i.e. \\(z_\\text{obs}\\)? \\(z_\\text{obs}=\\) What is the rejection region? \\(z_\\text{obs}\\) &gt;&lt; Solution For an upper-tail one-sided hypothesis test using the normal distribution with \\(\\alpha = 0.1\\), the rejection region is \\(z_{obs} &gt; z_{0.9}\\). From the statistical tables or from R, the critical value, \\(z_{0.9}\\) is 1.2816 and the rejection region is therefore \\(z_{obs} &gt; 1.2816\\). qnorm(0.9) ## [1] 1.281552 With continuity correction, the standardised test statistic can be calculated as: \\[ \\begin{align} z_{obs} &amp;= \\frac{p-\\pi_0-\\frac{1}{2n}}{\\sqrt{\\frac{\\pi_0(1-\\pi_0)}{n}}}\\\\ &amp;=\\frac{\\frac{174}{218}-0.75-\\frac{1}{436}}{\\sqrt{\\frac{0.75(1-0.75)}{218}}}\\\\ &amp;=1.5641 \\end{align} \\] ## [1] 1.564124 Another approach to performing a hypothesis test is to calculate the \\(p\\)-value. What is the \\(p\\)-value in this case? \\(p\\)-value\\(=\\) Solution The \\(p\\)-value is the area under the normal distribution curve that corresponds to the standardised test statistics (with continuity correction) we just calculated, i.e. \\(P(Z \\geq z_\\text{obs})\\). This can be found in the statistical tables or in R: pnorm(zobs, lower=FALSE) ## [1] 0.05889425 We can also find the value of standardised test statistic and \\(p\\)-value using the R function prop.test. With continuity correction: prop.test(x = yobs, n = n, p = 0.75, alternative = &quot;greater&quot;, correct = TRUE) ## ## 1-sample proportions test with continuity correction ## ## data: yobs out of n, null probability 0.75 ## X-squared = 2.4465, df = 1, p-value = 0.05889 ## alternative hypothesis: true p is greater than 0.75 ## 95 percent confidence interval: ## 0.7474708 1.0000000 ## sample estimates: ## p ## 0.7981651 Without continuity correction: prop.test(x = yobs, n = n, p = 0.75, alternative = &quot;greater&quot;, correct = FALSE) ## ## 1-sample proportions test without continuity correction ## ## data: yobs out of n, null probability 0.75 ## X-squared = 2.6972, df = 1, p-value = 0.05026 ## alternative hypothesis: true p is greater than 0.75 ## 95 percent confidence interval: ## 0.7499209 1.0000000 ## sample estimates: ## p ## 0.7981651 Adding the continuity correction reduces the value of the standardised test statistic, so the \\(p\\)-value obtained with continuity correction will be larger than the \\(p\\)-value obtained without continuity correction. 3.2.4 Step 4 &amp; 5 - Statistical and English Conclusion Do we obtain the same conclusion as the exact test? Yes, we reject the null hypothesis and conclude that there is sufficient evidence to substantiate the claim that over 75% of all apartments have an elevator. No, we fail to reject the null hypothesis and conclude that there is not sufficient evidence to substantiate the claim that over 75% of all apartments have an elevator. Solution I. From the rejection region, we reject \\(H_0\\) because \\(z_{obs} = 1.5641\\) is greater than 1.2816 and is therefore inside the rejection region when using continuity correction. OR From the p-value, we reject \\(H_0\\) because the \\(p\\)-value (with continuity correction) \\(0.0589\\) is less than 0.1. Whichever method we use, we reject \\(H_0\\). "],["exercise-1-chi-squared-test-for-association.html", "4 Exercise 1: Chi-squared test for association 4.1 Contingency tables 4.2 Hypothesis testing", " 4 Exercise 1: Chi-squared test for association The sinking of the Titanic occurred on the 15th of April in 1912. The data frame TITANIC3 in the PASWR2package contains information regarding class, sex, and survival as well as several other variables. TITANIC3 &lt;- TITANIC3 4.1 Contingency tables In order to analyse the associations between these variables we should make contingency tables. For example for a contingency table for passenger class versus survival we can use the code: TABLE1 &lt;- xtabs(~ pclass + survived, data = TITANIC3) TABLE1 ## survived ## pclass 0 1 ## 1st 123 200 ## 2nd 158 119 ## 3rd 528 181 Question Using xtabs() and other tools you have learnt such as subset() (or [] and $), subset your data and create contingency tables of: male passengers’ class versus survival, and female passengers’ class versus survival. At the time of data collection in 1912, passenger gender was recorded as 'sex' and separated only into 'male' or 'female'. Solution TABLE2 &lt;- xtabs(~ pclass + survived, data = subset(TITANIC3, sex == &quot;male&quot;)) TABLE3 &lt;- xtabs(~ pclass + survived, data = subset(TITANIC3, sex == &quot;female&quot;)) #OR MEN &lt;- TITANIC3[TITANIC3$sex==&quot;male&quot;,] TABLE2 &lt;- xtabs(~ pclass + survived, data = MALES) WOMEN &lt;- TITANIC3[TITANIC3$sex==&quot;female&quot;,] TABLE3 &lt;- xtabs(~ pclass + survived, data = WOMEN) #To view the tables TABLE2 ## survived ## pclass 0 1 ## 1st 118 61 ## 2nd 146 25 ## 3rd 418 75 TABLE3 ## survived ## pclass 0 1 ## 1st 5 139 ## 2nd 12 94 ## 3rd 110 106 4.2 Hypothesis testing To test if there is an association between class and survival generally for all passengers or for men and/or women, we should complete Chi-Squared Hypothesis Tests. This can be done using: TEST1 &lt;- chisq.test(TABLE1) TEST1 ## ## Pearson&#39;s Chi-squared test ## ## data: TABLE1 ## X-squared = 127.86, df = 2, p-value &lt; 2.2e-16 With a \\(p\\)-value of less than 0.05, this suggests there is a significant association between class and survival of passengers generally. Question Test if there is an association between class and survival for men and women on the titanic: The p-values for both tests were less than 0.05 meaning there is an association between class and survival for men and for women. The p-value for the test on male passengers was less than 0.05 while it was greater than 0.05 for women meaning there is an association between class and survival for men but not for women The p-value for the test on male passengers was greater than 0.05 while it was less than 0.05 for women meaning there is an association between class and survival for women but not for men The p-values for both tests were gretter than 0.05 meaning there was no evidence of an association between class and survival for men nor for women. Solution Code TEST2 &lt;- chisq.test(TABLE2) TEST2 ## ## Pearson&#39;s Chi-squared test ## ## data: TABLE2 ## X-squared = 33.033, df = 2, p-value = 6.714e-08 TEST3 &lt;- chisq.test(TABLE3) TEST3 ## ## Pearson&#39;s Chi-squared test ## ## data: TABLE3 ## X-squared = 115.7, df = 2, p-value &lt; 2.2e-16 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
