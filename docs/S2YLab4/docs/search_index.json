[["index.html", "Lab 4 - Exploring relationships and Understanding correlation 1 Welcome to Lab 3 1.1 Credit where credit is due", " Lab 4 - Exploring relationships and Understanding correlation 1 Welcome to Lab 3 Intended Learning Outcomes: Produce scatterplots of report quality; Calculate and interpret the sample correlation coefficient; Fit linear regression models by using lm; Interpret least squares estimates of model parameters. 1.1 Credit where credit is due The labs in S2 incorporate and adapt materials from: Ugarte, M. D., Militino, A. F., &amp; Arnholt, A. T. (2008). Probability and Statistics with R. CRC press. The materials were converted into interactive labs on Hypothesis Testing using Bookdown and webexercises in Summer 2023 by summer project student, Megan Ruffle. "],["exercise-1---chi-squared-test-for-association.html", "2 Exercise 1 - Chi-squared test for association 2.1 Contingency tables 2.2 Hypothesis Testing", " 2 Exercise 1 - Chi-squared test for association The sinking of the Titanic occurred on the 15th of April in 1912. The data frame TITANIC3 in the PASWR2package contains information regarding class, sex, and survival as well as several other variables. TITANIC3 &lt;- TITANIC3 2.1 Contingency tables In order to analyse the associations between these variables we should make contingency tables. For example for a contingency table for passenger class versus survival we can use the code: TABLE1 &lt;- xtabs(~ pclass + survived, data = TITANIC3) TABLE1 ## survived ## pclass 0 1 ## 1st 123 200 ## 2nd 158 119 ## 3rd 528 181 Question Using xtabs() and other tools you have learnt such as subset() (or [] and $), subset your data and create contingency tables of: male passengers’ class versus survival, and female passengers’ class versus survival. At the time of data collection in 1912, passenger gender was recorded as 'sex' and separated only into 'male' or 'female' Solution TABLE2 &lt;- xtabs(~ pclass + survived, data = subset(TITANIC3, sex == &quot;male&quot;)) TABLE3 &lt;- xtabs(~ pclass + survived, data = subset(TITANIC3, sex == &quot;female&quot;)) #OR MEN &lt;- TITANIC3[TITANIC3$sex==&quot;male&quot;,] TABLE2 &lt;- xtabs(~ pclass + survived, data = MALES) WOMEN &lt;- TITANIC3[TITANIC3$sex==&quot;female&quot;,] TABLE3 &lt;- xtabs(~ pclass + survived, data = WOMEN) #To view the tables TABLE2 ## survived ## pclass 0 1 ## 1st 118 61 ## 2nd 146 25 ## 3rd 418 75 TABLE3 ## survived ## pclass 0 1 ## 1st 5 139 ## 2nd 12 94 ## 3rd 110 106 2.2 Hypothesis Testing To test if there is an association between class and survival generally for all passengers or for men and/or women, we should complete Chi-Squared Hypothesis Tests. This can be done using: TEST1 &lt;- chisq.test(TABLE1) TEST1 ## ## Pearson&#39;s Chi-squared test ## ## data: TABLE1 ## X-squared = 127.86, df = 2, p-value &lt; 2.2e-16 With a p-value of less than 0.05, this suggests there is a significant association between class and survival of passengers generally. Question Test if there is an association between class and survival for men an women on the titanic: The p-values for both tests were less than 0.05 meaning there is an association between class and survival for men and for women. The p-value for the test on male passengers was less than 0.05 while it was greater than 0.05 for women meaning there is an association between class and survival for men but not for women The p-value for the test on male passengers was greater than 0.05 while it was less than 0.05 for women meaning there is an association between class and survival for women but not for men The p-values for both tests were gretter than 0.05 meaning there was no evidence of an association between class and survival for men nor for women. Solution Code TEST2 &lt;- chisq.test(TABLE2) TEST2 ## ## Pearson&#39;s Chi-squared test ## ## data: TABLE2 ## X-squared = 33.033, df = 2, p-value = 6.714e-08 TEST3 &lt;- chisq.test(TABLE3) TEST3 ## ## Pearson&#39;s Chi-squared test ## ## data: TABLE3 ## X-squared = 115.7, df = 2, p-value &lt; 2.2e-16 "],["exercise-2-simple-linear-regression-slr.html", "3 Exercise 2: Simple linear regression (SLR) 3.1 Creating scatterplots 3.2 Fitting a linear model", " 3 Exercise 2: Simple linear regression (SLR) The admissions committee of a comprehensive state university selected at random the records of 200 second-semester freshmen. The results, first-semester college GPA and SAT scores, are stored in the data set Grades in the package PASWR. The admissions committee wants to study the relationship between first-semester college grade point average (gpa) and scholastic aptitude test (sat) scores. To open this data file, type: library(PASWR) Grades &lt;- Grades This will assign the data to the object Grades. A spreadsheet of the data can be viewed by typing: fix(GRADES) but note that you will need to close this window before trying to excute any further commands. The spreadsheet can also be viewed by clicking on the GRADES object in the Workspace (top right of the screen). 3.1 Creating scatterplots The relationship between gpa and sat scores can be examined by using a scatterplot. This code will produce the basic scatterplot of gpa (y-axis) against sat (x-axis): plot(gpa ~ sat, data = Grades) Figure 3.1: Scatterplot of gpa versus sat. There are several options for personalising plots. First of all, you should add sensible axis labels to the plot and a main title. For example, by typing: plot(gpa ~ sat, data = Grades, xlab = &quot;SAT score&quot;, ylab = &quot;GPA&quot;, main=&quot;Scatterplot of GPA versus SAT scores&quot;) Figure 3.2: Scatterplot of gpa versus sat with annotated axis labels. You can also edit the points by changing the symbol type, size and colour, such as plot(gpa ~ sat, data = Grades, xlab = &quot;SAT score&quot;, ylab = &quot;GPA&quot;, main = &quot;Scatterplot of GPA versus SAT scores&quot;, pch = 2, cex = 0.7, col = &quot;blue&quot;) The plotting character is determined by the pch argument, the size of the plotted characters by cex, and the colour by the col argument. DISCUSSION: Looking at your plot, what can we say about the relationship between gpa and sat? Is the relationship linear or non-linear? Is the relationship positive or negative? How strong is the relationship? 3.2 Fitting a linear model To find the equation that best describes the relationship between gpa and sat use: model.lm&lt;- lm(gpa ~ sat, data = Grades) model.lm ## ## Call: ## lm(formula = gpa ~ sat, data = Grades) ## ## Coefficients: ## (Intercept) sat ## -1.192064 0.003094 This fits a simple linear regression model with the response variable gpa and the explanatory variable sat. From the R output, note down the equation of the fitted line that is given: (Enter your answers to 3 decimal places.) gpa = + sat This is the line of best fit, describing the effect of sat on gpa. QUESTION: Which of the following is the correct interpretation of the regression model? The intercept of the fitted line is -1.192, so for every unit increase in sat, we expect gpa to decrease by 1.192. The intercept of the fitted line is -1.192, so for every unit increase in gpa, we expect sat to decrease by 1.192. The slope coefficient of the fitted line is 0.0031, so for every unit increase in sat, we expect gpa to increase by 0.0031. The coefficient of the fitted line is 0.0031, so for every unit increase in gpa, we expect sat to increase by 0.0031. QUESTION: Use R to calculate the point estimate of the change in the mean GPA when the SAT score increases by 50 points. Solution coef(model.lm)[1]*50 ## (Intercept) ## -59.60319 Plot of the data including the fitted line A plot of the data can be re-produced as before with the fitted line added using the abline command. This command uses the intercept and slope information from the fitted line saved in model.lm. This is done using: plot(gpa ~ sat, data = Grades, xlab = &quot;SAT score&quot;, ylab = &quot;GPA&quot;, main = &quot;Scatterplot of GPA versus SAT scores&quot;, pch=20) abline(model.lm) Another way to assess the relationship is with the Pearson Correlation Coefficient \\(r\\). In your lectures, you will have seen how to calculate this by hand using the formula: \\[r= \\frac{\\sum_{i=1}^n(x_i-\\bar{x})(y_i-\\bar{y})}{\\sqrt{\\sum_{i=1}^n(x_i-\\bar{x})^2\\sum_{i=1}^n(y_i-\\bar{y})^2}}\\] In R we can use cor(): cor(x=Grades$sat,y=Grades$gpa, method=&quot;pearson&quot;) ## [1] 0.7491015 The correlation coefficient varies from a strong negative correlation \\(r=-1\\), to no correlation \\(r=0\\), to a strong positive correlation \\(r=1\\). QUESTION: Which of the following is the correct interpretation of the correlation coefficient? 74.9% correlation would indicate a weak negative relationship between GPA and SAT scores. 74.9% correlation would indicate a strong negative relationship between GPA and SAT scores. 74.9% correlation would indicate a weak positive relationship between GPA and SAT scores. 74.9% correlation would indicate a strong positive relationship between GPA and SAT scores. "],["exercise-3-spurious-correlation.html", "4 Exercise 3: Spurious correlation 4.1 Investigating a relationship with regression 4.2 Further analsyis with a Correlation Coefficient 4.3 Spurious Correlation", " 4 Exercise 3: Spurious correlation Hollywood legend Nicholas Cage seems to have a problem. It appears that every time he releases a new film upon the world, many people drown by falling into pools of water. Coincidence? Or, are some of his films that bad? Data: Cage.csv Columns:               C1: Year Year of film releases               C2: NumFilms   Number of Nicholas Cage films released that year               C3: NumDrowns Number of people who drowned falling into pools that year To access the data, download the file Cage.csv from Moodle and make sure it is saved in an accessible file. The working directory of your RStudio Session should be set to that folder. Once this is done, read in the data using: Cage &lt;- read.csv(&quot;Cage.csv&quot;) 4.1 Investigating a relationship with regression To investigate the relationship between the number of films released in any year against the number of people drowning we should make a scatterplot. 1a) Produce a scatterplot of NumDrowned \\(y\\) against NumFilms \\(x\\) with labels and a sensible title. Hint You can use plot() such as in the previous example with Grades. Or you can refer to previous weeks labs and use ggplot() Solutions plot(NumDrowned ~ NumFilms, data = Cage, xlab = &quot;Number of films released per year&quot;, ylab = &quot;Number of people drowning per year&quot;, main=&quot;Scatterplot of the Number of People Drowning VS Number of Films Released Per Year&quot;, pch=20) 1b) Create a linear model for this data and add it to your scatterplot. Hint The function lm() should be used. Remember to specify the correct column names you want to compare and the dataset they are found in. Solutions model &lt;- lm(NumDrowned ~ NumFilms, data = Cage) model ## ## Call: ## lm(formula = NumDrowned ~ NumFilms, data = Cage) ## ## Coefficients: ## (Intercept) NumFilms ## 87.134 5.821 plot(NumDrowned ~ NumFilms, data = Cage, xlab = &quot;Number of Nicholas Cage films released in a year&quot;, ylab = &quot;Number of people who drowned falling into pools that year&quot;, main=&quot;Scatterplot of the number of people drowning VS number of films released per year&quot;, pch=20) abline(model) 1c) What is a sensible interpretation of this model and the relationship between the number of films released in any year against the number of people drowning? Solutions The relationship appears linear and positive on the plot and the coefficient of x in our model NumDrowned = 87.134 + 5.821*NumFilms is also positive reinforcing this suggestion. 4.2 Further analsyis with a Correlation Coefficient cor(x=Cage$NumFilms, y=Cage$NumDrowned, method=&quot;pearson&quot;) ## [1] 0.6660043 How should we interpret these results? The sample correlation coefficient is 0.666, indicating a weak positive linear relationship between NumDrowned and NumFilms The sample correlation coefficient is 0.666, indicating a moderate positive linear relationship between NumDrowned and NumFilms The sample correlation coefficient is 0.666, indicating a strong neagtive linear relationship between NumDrowned and NumFilms The sample correlation coefficient is 0.666, indicating no significant relationship between NumDrowned and NumFilms Does this mean that Nicolas Cage films are causing drownings? Quite obviously, the answer to this would be no. This is only correlation not causation. Additionally these results were taken from an observational study not an experiment so causation could not be commented on here. 4.3 Spurious Correlation This is an example of spurious correlation, where two variables that are not related to each other in any way, that is, they are independent, could be inferred as being related. The number of Nicholas Cage films released in a year is clearly not related to the number of drowning accidents in that same year, but if we just take our correlation hypothesis test on face value, then we would think otherwise. Reference: Spurious Correlations, Tyler Vigen "],["exercise-4-multiple-linear-regression.html", "5 Exercise 4: Multiple linear regression 5.1 Exploratory analysis 5.2 Fitting a linear model", " 5 Exercise 4: Multiple linear regression Hydrostatic weighing, also known as underwater weighing or hydrodensitometry, is one of the most accurate ways to measure body fat. The body fat of 78 high school wrestlers was measured using three separate techniques, namely hydrostatic weighing, skin fold measurements and the Tanita body fat scale. The results are stored in the data set HSwrestler in the PASWR package. Read in the data using: library(PASWR) HSWRESTLER &lt;- HSwrestler The data set contains nine columns, described as follows: AGE: age of wrestler in years HT: height of wrestler in inches WT: weight of wrestler in pounds ABS: abdominal fat TRICEPS: tricep fat SUBSCAP: subscapular fat HWFAT: hydrostatic fat TANFAT: Tanita fat SKFAT: skin fat This can be seen by typing: names(HSWRESTLER) In this example, it is of interest to investigate how hydrostatic fat (HWFAT) is related to abdominal fat (ABS) and tricep fat (TRICEPS). 5.1 Exploratory analysis TASK 1 Produce scatterplots of HWFAT (y) against Lactic ABS (x), and HWFAT (y) against TRICEPS (x). Describe the relationship between HWFAT (y), ABS (x) and TRICEPS. 5.2 Fitting a linear model In Example 1, the function lm() was used to find estimates for parameters of a simple linear regression model. The same function can be used for multiple linear regression models by specifying the explanatory variables on the right side of the tilde (~) operator inside the lm() function. To build a multiple linear regression model with hwfat as the response variable and abs and triceps (tricep fat) as explanatory variables, type: lm(HWFAT ~ ABS + TRICEPS, data = HSWRESTLER) Note down the equation of the fitted line from that is given: HWFAT = + ABS + TRICEPS QUESTION: Interpret what each coefficient means. For every unit increase in abdominal fat, hydrostatic fat is expected to increasedecrease by 0.3370.5042.059 unit, regardless of tricep fatwhile holding tricep fat constant. For every unit increase in tricep fat, hydrostatic fat is expected to increasedecrease by 0.3370.5042.059 unit, regardless of abdominal fatwhile holding abdominal fat constant. "],["exercise-5-identifying-relationships.html", "6 Exercise 5: Identifying relationships", " 6 Exercise 5: Identifying relationships If we had data for the following studies, determine whether fitting a regression model would be appropriate or produce meaningful results. If a regression model is appropriate, identify which variable is the response variable and which is the explanatory variable. A study investigated whether federal spending, on average, is higher or lower in countries with higher rates of poverty.        Regression model appropriate? YesNo        Federal spending: ExplanatoryResponseN/A        Poverty rates: ExplanatoryResponseN/A A study was conducted to determine whether surgery or chemotherapy results in higher survival rates for a certain type of cancer.        Regression model appropriate? YesNo        Type of treatment: ExplanatoryResponseN/A        Survival rates: ExplanatoryResponseN/A A study found that, overall, left-handed people die at a younger age than right-handed people.        Regression model appropriate? YesNo        Age of death: ExplanatoryResponseN/A        Left- or right-handed: ExplanatoryResponseN/A A study to determine if per capita cheese consumption is correlated with the number of people who died getting tangled in bed sheets.        Regression model appropriate? YesNo        Number of people who died getting tangled in bed sheets: ExplanatoryResponseN/A        Per capita cheese consumption: ExplanatoryResponseN/A An experiment was conducted to test the effects of sleep deprivation on human reaction times.        Regression model appropriate? YesNo        Hours of sleep: ExplanatoryResponseN/A        Reaction times: ExplanatoryResponseN/A A study was conducted in order to predict the GPA of university students given their high school GPA.        Regression model appropriate? YesNo        GPA of university students: ExplanatoryResponseN/A        High school GPA: ExplanatoryResponseN/A A company ran a study to find out if there is a significant relationship between its advertising expenditures and its sales volume.        Regression model appropriate? YesNo        Advertising expenditures: ExplanatoryResponseN/A        Sales volume: ExplanatoryResponseN/A A sample of insured drivers with similar insurance policies were randomly selected. Interest is in determining whether there is a significant relationship between driving experience and insurance premium.        Regression model appropriate? YesNo        Driving experience: ExplanatoryResponseN/A        Insurance premium: ExplanatoryResponseN/A A study was run to investigate if ice cream sales are correlated with murder rates in the US.        Regression model appropriate? YesNo        Murder rates: ExplanatoryResponseN/A        Ice cream sales: ExplanatoryResponseN/A "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
