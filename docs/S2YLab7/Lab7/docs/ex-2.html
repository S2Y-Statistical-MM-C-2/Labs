<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Exercise 1: From beginning to end | main.knit</title>
  <meta name="description" content="S2Y Lab 7<br />
Further examination on model fit and assumptions - ANOVA, residual plots and transformations</div>" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Exercise 1: From beginning to end | main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Exercise 1: From beginning to end | main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ex-1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to S2Y Lab 5</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#let-us-prepare"><i class="fa fa-check"></i><b>1.2</b> Let us prepare</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ex-1.html"><a href="ex-1.html"><i class="fa fa-check"></i><b>2</b> Example 1: Log-transformation on <span class="math inline">\(x\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="ex-1.html"><a href="ex-1.html#exploratory-analysis"><i class="fa fa-check"></i><b>2.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="2.2" data-path="ex-1.html"><a href="ex-1.html#statistical-analysis"><i class="fa fa-check"></i><b>2.2</b> Statistical analysis</a></li>
<li class="chapter" data-level="2.3" data-path="ex-1.html"><a href="ex-1.html#assumption-checking"><i class="fa fa-check"></i><b>2.3</b> Assumption checking</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ex-2.html"><a href="ex-2.html"><i class="fa fa-check"></i><b>3</b> Exercise 1: From beginning to end</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ex-2.html"><a href="ex-2.html#part-i-construct-anova-table"><i class="fa fa-check"></i><b>3.1</b> Part I: Construct ANOVA table</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ex-2.html"><a href="ex-2.html#constructing-an-anova-table"><i class="fa fa-check"></i><b>3.1.1</b> Constructing an ANOVA table</a></li>
<li class="chapter" data-level="3.1.2" data-path="ex-2.html"><a href="ex-2.html#testing-for-linear-relationships"><i class="fa fa-check"></i><b>3.1.2</b> Testing for linear relationships</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ex-2.html"><a href="ex-2.html#ex-2"><i class="fa fa-check"></i><b>3.2</b> Part II: <span class="math inline">\(R^2\)</span> and linear model assumption</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ex-2.html"><a href="ex-2.html#methods"><i class="fa fa-check"></i><b>3.2.1</b> Methods</a></li>
<li class="chapter" data-level="3.2.2" data-path="ex-2.html"><a href="ex-2.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>3.2.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="ex-2.html"><a href="ex-2.html#statistical-analysis-1"><i class="fa fa-check"></i><b>3.2.3</b> Statistical analysis</a></li>
<li class="chapter" data-level="3.2.4" data-path="ex-2.html"><a href="ex-2.html#assumption-checking-1"><i class="fa fa-check"></i><b>3.2.4</b> Assumption checking</a></li>
<li class="chapter" data-level="3.2.5" data-path="ex-2.html"><a href="ex-2.html#regression-output"><i class="fa fa-check"></i><b>3.2.5</b> Regression output</a></li>
<li class="chapter" data-level="3.2.6" data-path="ex-2.html"><a href="ex-2.html#conclusion"><i class="fa fa-check"></i><b>3.2.6</b> Conclusion</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">S2Y Lab 7<br />
Further examination on model fit and assumptions - ANOVA, residual plots and transformations</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ex-2" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Exercise 1: From beginning to end<a href="ex-2.html#ex-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="part-i-construct-anova-table" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Part I: Construct ANOVA table<a href="ex-2.html#part-i-construct-anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- ## `HSWRESTLER` dataset part I {-#hswrestler}  -->
<p>To use the <code>HSWRESTLER</code> data set, you will need to install and use the <code>PASWR2</code> package.</p>
<p>To install the <code>PASWR2</code> package, use <code>install.packages("PASWR2)</code>.</p>
<p>Then enter the following code to obtain the data set <code>HSWRESTLER</code>:</p>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<div id="constructing-an-anova-table" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Constructing an ANOVA table<a href="ex-2.html#constructing-an-anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Construct an ANOVA table using the data in <code>HSWRESTLER</code>. Then, test if a linear relationship exists between the hydrostatic fat level (<code>hwfat</code>) and tricep fat (<code>triceps</code>) using the information in the ANOVA table at the <span class="math inline">\(\alpha = 0.05\)</span> level.</p>
<p>Start by fitting the model and computing the ANOVA table.</p>
<div class="webex-solution">
<button>
Hint: ANOVA table
</button>
<p>Use the function <code>anova()</code> to obtain the ANOVA table.</p>
</div>
<div class="webex-solution">
<button>
Solution: ANOVA table code and output
</button>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ex-2.html#cb3-1" tabindex="-1"></a>model.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(hwfat <span class="sc">~</span> triceps, <span class="at">data =</span> HSWRESTLER)</span>
<span id="cb3-2"><a href="ex-2.html#cb3-2" tabindex="-1"></a><span class="fu">anova</span>(model.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: hwfat
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## triceps    1 5056.3  5056.3  399.65 &lt; 2.2e-16 ***
## Residuals 76  961.5    12.7                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="testing-for-linear-relationships" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Testing for linear relationships<a href="ex-2.html#testing-for-linear-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Test if a linear relationship exists between <code>hwfat</code> and <code>triceps</code> using the information in the ANOVA table at the <span class="math inline">\(\alpha = 0.05\)</span> level.</p>
<p>Step 1: Calculate the rejection region, i.e., <span class="math inline">\(F_{obs}\)</span>.</p>
<p><span class="math inline">\(F_{obs} =\)</span> <input class='webex-solveme nospaces' size='8' data-answer='["398.1339"]'/></p>
<div class="webex-solution">
<button>
Hint: How to calculate <span class="math inline">\(F_{obs}\)</span>
</button>
<p>Because <span class="math inline">\(F_{obs} \sim F_{1,76}\)</span> and this is a one-tailed test, the rejection region is <span class="math inline">\(F_{obs} &gt; F_{0.95;1,76} = 3.9691\)</span> (from the statistical tables). The value of the standardised test statistic is <span class="math inline">\(F_{obs} = \frac{MSR}{MSE}\)</span>. This is also found in the ANOVA table output (note that the values will be slightly different due to the rounding).</p>
</div>
<div class="webex-solution">
<button>
Solution: <span class="math inline">\(F_{obs}\)</span>
</button>
<p><span class="math inline">\(F_{obs} = \frac{MSR}{MSE} = \frac{5056.3}{12.7} = 398.1339\)</span></p>
</div>
<p>Step 2: Use the p-value (<code>Pr(&gt;|F|))</code>) in the ANOVA table to determine whether to reject <span class="math inline">\(H_0\)</span> or not.
1. From the rejection region, we <select class='webex-select'><option value='blank'></option><option value='answer'>reject</option><option value=''>do not reject</option></select> <span class="math inline">\(H_0\)</span> because <span class="math inline">\(F_{obs}\)</span> is <select class='webex-select'><option value='blank'></option><option value=''>less than</option><option value='answer'>greater than</option></select> 3.9691.
2. From the p-value, we <select class='webex-select'><option value='blank'></option><option value='answer'>reject</option><option value=''>do not reject</option></select> <span class="math inline">\(H_0\)</span> because the value for <code>Pr(&gt;|F|))</code> is <select class='webex-select'><option value='blank'></option><option value=''>greater than</option><option value='answer'>less than</option></select> 0.05.</p>
<p>Step 3: Interpret your results.
There is <select class='webex-select'><option value='blank'></option><option value='answer'>strong evidence</option><option value=''>insufficient evidence</option></select> that suggests a linear relationship exists between the variables <code>hwfat</code> and <code>triceps</code>.</p>
<p>Compute <span class="math inline">\(R^2\)</span> based on <code>anova(model.lm)</code> (it should be the same as the value returned in <code>summary(model.lm)</code>)</p>
<p><span class="math inline">\(R^2 =\)</span> <input class='webex-solveme nospaces' size='6' data-answer='["0.8402",".8402"]'/></p>
<div class="webex-solution">
<button>
Hint: How to calculate <span class="math inline">\(R^2\)</span>
</button>
<p>The formula for <span class="math inline">\(R^2\)</span> is
<span class="math inline">\(R^2 = \frac{SST}{SST + SSE}\)</span></p>
</div>
<div class="webex-solution">
<button>
Solution: <span class="math inline">\(R^2\)</span>
</button>
<p><span class="math inline">\(R^2 = \frac{SST}{SST + SSE} = \frac{5056.3}{5056.3+961.5} = 0.8402\)</span></p>
</div>
</div>
</div>
<div id="ex-2" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Part II: <span class="math inline">\(R^2\)</span> and linear model assumption<a href="ex-2.html#ex-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- ## `HSWRESTLER` dataset part II {-#hswrestler-pt-2}  -->
<p>Our main question of interest is if the hydrostatic fat (<code>hwfat</code>) can be determined from the tricep fat level (<code>triceps</code>).</p>
<div id="methods" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Methods<a href="ex-2.html#methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will model the relationship between hydrostatic fat and tricep fat using a simple linear regression model and then check if this model is appropriate for the data. The model is given as</p>
<p align="center">
<span class="math inline">\(Y_i = \alpha + \beta x_i + \epsilon_i\)</span>,
</p>
<p>where
(a) the deterministic part of the model captures all the non-random structure in the data;
(b) the random errors, <span class="math inline">\(\epsilon_i\)</span>, have constant variance;
(c) the random errors, <span class="math inline">\(\epsilon_i\)</span>, are independent;
(d) the random errors, <span class="math inline">\(\epsilon_i\)</span>, are normally distributed;
(e) the explanatory variable, <span class="math inline">\(x\)</span>, is recorded without error.</p>
<p>We will consider assumptions (a)-(d) in this practical (assumption (e) cannot be assessed by examining the data).</p>
</div>
<div id="exploratory-analysis-1" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Exploratory analysis<a href="ex-2.html#exploratory-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Firstly, produce a scatterplot of the response variable <code>hwfat</code> (<span class="math inline">\(y\)</span>), against the predictor variable <code>triceps</code> (<span class="math inline">\(x\)</span>).</p>
<div class="webex-solution">
<button>
Hint: Code for plot
</button>
<p>Use the <code>plot()</code> command with <code>hwfat</code> as the response variable and <code>triceps</code> as the explanatory variable.</p>
</div>
<div class="webex-solution">
<button>
Solution: Plot code and output
</button>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ex-2.html#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(hwfat <span class="sc">~</span> triceps, <span class="at">data =</span> HSWRESTLER, <span class="at">xlab =</span> <span class="st">&quot;Tricep fat percentage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Hydrostatic fat percentage&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/hs-plot-1.png" width="672" /></p>
</div>
<p>What can we say about the relationship between <code>hwfat</code> and <code>triceps</code>?</p>
<div id="radio_WQYWZOPEQA" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WQYWZOPEQA" value=""></input> <span>There is a moderate negative relationship</span></label><label><input type="radio" autocomplete="off" name="radio_WQYWZOPEQA" value=""></input> <span>There is a weak negative relationship</span></label><label><input type="radio" autocomplete="off" name="radio_WQYWZOPEQA" value="answer"></input> <span>There is a moderate positive relationship</span></label><label><input type="radio" autocomplete="off" name="radio_WQYWZOPEQA" value=""></input> <span>There is no relationship</span></label>
</div>
</div>
<div id="statistical-analysis-1" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Statistical analysis<a href="ex-2.html#statistical-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A simple linear regression model can be fitted in <code>R</code> using the <code>lm()</code> command.</p>
<p>Fit a simple linear regression model to the <code>HSWRESTLER</code> data, with <code>hwfat</code> as the response variable and <code>triceps</code> as the explanatory variable.</p>
<div class="webex-solution">
<button>
Solution: Code for model fit
</button>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ex-2.html#cb6-1" tabindex="-1"></a>model.hs <span class="ot">&lt;-</span> <span class="fu">lm</span>(hwfat <span class="sc">~</span> triceps, <span class="at">data =</span> HSWRESTLER)</span></code></pre></div>
</div>
</div>
<div id="assumption-checking-1" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Assumption checking<a href="ex-2.html#assumption-checking-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before assessing the fit of the model, it is important to check that the assumptions underlying the model are satisfied. In order to do this, we need to obtain the residuals after fitting the model. These can be obtained using the commands:</p>
<p align="center">
<code>residuals(model.hs)</code>
<code>rstandard(model.hs)</code>
</p>
<p>with the latter command providing the standardised residuals. These commands can be used to produce a plot of the residuals versus the fitted values and a normal probability plot (Q-Q plot) of the residuals to graphically assess assumptions (a), (b), and (d).</p>
<p>Plot the standardised residuals versus fitted values.</p>
<div class="webex-solution">
<button>
Hint: Code for plot
</button>
<p>Use the function <code>plot()</code> with <code>rstandard()</code> and <code>fitted()</code> for the residuals versus fitted values.</p>
</div>
<div class="webex-solution">
<button>
Solution: Plot code and output
</button>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ex-2.html#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rstandard</span>(model.hs) <span class="sc">~</span> <span class="fu">fitted</span>(model.hs))</span>
<span id="cb7-2"><a href="ex-2.html#cb7-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/resids-plot-hs-1.png" width="672" /></p>
</div>
<p>Plot the normal probability (Q-Q) plot, including a line.</p>
<div class="webex-solution">
<button>
Hint: Code for plot
</button>
<p>Use the function <code>qqnorm()</code> with the <code>rstandard()</code> function, and add a line with the function <code>qqline()</code>.</p>
</div>
<div class="webex-solution">
<button>
Solution: Plot code and output
</button>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="ex-2.html#cb8-1" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">rstandard</span>(model.hs))</span>
<span id="cb8-2"><a href="ex-2.html#cb8-2" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">rstandard</span>(model.hs), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/qq-plot-hs-1.png" width="672" /></p>
</div>
<p>From the plot, we can see that the points lie <select class='webex-select'><option value='blank'></option><option value='answer'>somewhat close to</option><option value=''>away from</option></select> the line of equality (<span class="math inline">\(y=x\)</span>). This means that it is <select class='webex-select'><option value='blank'></option><option value=''>not reasonable</option><option value='answer'>quite reasonable</option></select> to assume that <strong>the random errors are normally distributed</strong>. Note that this assumption is required only when we wish to make inferences about the parameters of the model to be applied to some wider population.</p>
<p>Now, plot the histogram of residuals using the function <code>hist()</code>.</p>
<div class="webex-solution">
<button>
Hint: Code for plot
</button>
<p>Use the function <code>hist()</code> and <code>rstandard()</code> to plot the histogram of residuals.</p>
</div>
<div class="webex-solution">
<button>
Solution: Plot code and output
</button>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="ex-2.html#cb9-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rstandard</span>(model.hs))</span></code></pre></div>
<p><img src="main_files/figure-html/hist-plot-hs-1.png" width="672" /></p>
</div>
<p>From the plot above, the histogram <select class='webex-select'><option value='blank'></option><option value='answer'>shows</option><option value=''>does not show</option></select> a reasonably bell-shaped curve, and hence normality appears <select class='webex-select'><option value='blank'></option><option value=''>unreasonable</option><option value='answer'>quite reasonable</option></select>.</p>
</div>
<div id="regression-output" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Regression output<a href="ex-2.html#regression-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Obtain the regression model summary and examine the output.</p>
<div class="webex-solution">
<button>
Hint: Summary code
</button>
<p>Use the function <code>summary()</code> to examine regression output.</p>
</div>
<div class="webex-solution">
<button>
Solution: Summary code and output
</button>
<pre><code>## 
## Call:
## lm(formula = hwfat ~ triceps, data = HSWRESTLER)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.7634 -2.1184 -0.9116  2.2760 10.6725 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.57872    0.75035   2.104   0.0387 *  
## triceps      0.97647    0.04885  19.991   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.557 on 76 degrees of freedom
## Multiple R-squared:  0.8402, Adjusted R-squared:  0.8381 
## F-statistic: 399.6 on 1 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Print the analysis of variance (ANOVA) table.</p>
<div class="webex-solution">
<button>
Hint: ANOVA code
</button>
<p>Use the function <code>anova()</code> to obtain the ANOVA table.</p>
</div>
<div class="webex-solution">
<button>
Solution: ANOVA output
</button>
<pre><code>## Analysis of Variance Table
## 
## Response: hwfat
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## triceps    1 5056.3  5056.3  399.65 &lt; 2.2e-16 ***
## Residuals 76  961.5    12.7                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>From the summary table output we can see that the regression equation is
(<em>to 4 decimal places</em>)</p>
<p align="center">
Hydrostatic fat = <input class='webex-solveme nospaces' size='6' data-answer='["1.5787"]'/> + <input class='webex-solveme nospaces' size='6' data-answer='["0.9765",".9765"]'/> <span class="math inline">\(\cdot\)</span> tricep fat
</p>
<p>Again, from the summary table output, the value of the coefficient of determination, <span class="math inline">\(R^2\)</span>, is <input class='webex-solveme nospaces' size='5' data-answer='["84.02"]'/>%. This gives us the percentage of variation in <code>hwfat</code> that is explained by the linear regression model with <code>triceps</code> as a predictor. Hence <input class='webex-solveme nospaces' size='5' data-answer='["84.02"]'/>% of the variation in the price of a diamond ring is explained by taking into account the weight of the diamond using out simple linear regression model. Hence the model gives <select class='webex-select'><option value='blank'></option><option value='answer'>a relatively good</option><option value=''>an excellent</option><option value=''>a bad</option></select> fit to the data.</p>
<p>The adjusted coefficient of determination, <span class="math inline">\(R^2_a\)</span>, is also useful in examining model fit and can be obtained from the summary table output. In this case, <span class="math inline">\(R^2_a\)</span> is <input class='webex-solveme nospaces' size='5' data-answer='["83.81"]'/>%, which is <select class='webex-select'><option value='blank'></option><option value=''>higher</option><option value='answer'>lower</option></select> than the <span class="math inline">\(R^2\)</span> value.</p>
<p>Which of the two statistics, <span class="math inline">\(R^2\)</span> and <span class="math inline">\(R^2_a\)</span>, is more appropriate to assess the model goodness of fit?</p>
<div id="radio_RZIIJHIUPR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RZIIJHIUPR" value="answer"></input> <span><span class="math inline">\(R^2_a\)</span>, because it takes into account how many variables are in a model to determine the most appropriate variables to include.</span></label><label><input type="radio" autocomplete="off" name="radio_RZIIJHIUPR" value=""></input> <span><span class="math inline">\(R^2\)</span>, because it is always higher.</span></label>
</div>
<p>We can plot the data with the fitted line superimposed, such as in the Exploratory analysis section, using the command <code>abline()</code> after plotting the data.</p>
<div class="webex-solution">
<button>
Hint: Code for plot
</button>
<p>Use the function <code>plot()</code> with <code>hwfat</code> as the response variable and <code>triceps</code> as the explanatory variable, and use the function <code>abline()</code> to add a regression line to the plot.</p>
</div>
<div class="webex-solution">
<button>
Solution: Plot code and output
</button>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="ex-2.html#cb12-1" tabindex="-1"></a><span class="fu">plot</span>(hwfat <span class="sc">~</span> triceps, <span class="at">data =</span> HSWRESTLER, <span class="at">xlab =</span> <span class="st">&quot;Tricep fat percentage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Hydrostatic fat percentage&quot;</span>)</span>
<span id="cb12-2"><a href="ex-2.html#cb12-2" tabindex="-1"></a><span class="fu">abline</span>(model.hs, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/hs-plot-line-1.png" width="672" /></p>
</div>
</div>
<div id="conclusion" class="section level3 hasAnchor" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> Conclusion<a href="ex-2.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A simple linear regression model has provided <select class='webex-select'><option value='blank'></option><option value='answer'>a relatively good</option><option value=''>an excellent</option><option value=''>a bad</option></select> and <select class='webex-select'><option value='blank'></option><option value=''>inappropriate</option><option value='answer'>appropriate</option></select> model for predicting the price of a diamond ring from the weight of the diamond in the ring. <select class='webex-select'><option value='blank'></option><option value=''>None</option><option value='answer'>Most</option><option value=''>Almost all</option></select> of the variability in the response has been explained and the assumptions <select class='webex-select'><option value='blank'></option><option value='answer'>appear</option><option value=''>do not appear</option></select> justified.</p>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="ex-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
