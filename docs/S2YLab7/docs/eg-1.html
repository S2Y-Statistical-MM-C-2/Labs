<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Example 1: GRADES dataset | main.knit</title>
  <meta name="description" content="S2Y Lab 7<br />
Examining model fit – ANOVA and <span class="math inline">\(R^2\)</span></div>" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Example 1: GRADES dataset | main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Example 1: GRADES dataset | main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="ex2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to S2Y Lab 7</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#the-anova-table"><i class="fa fa-check"></i><b>1.1.1</b> The ANOVA table</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#r2"><i class="fa fa-check"></i><b>1.1.2</b> <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-brief-reminder-from-lab-6-the-summary-function"><i class="fa fa-check"></i><b>1.2</b> A brief reminder from Lab 6: The <code>summary()</code> function</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#exam-style-questions"><i class="fa fa-check"></i><b>1.3</b> Exam-style questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="eg-1.html"><a href="eg-1.html"><i class="fa fa-check"></i><b>2</b> Example 1: <code>GRADES</code> dataset</a>
<ul>
<li class="chapter" data-level="2.1" data-path="eg-1.html"><a href="eg-1.html#constructing-an-anova-table"><i class="fa fa-check"></i><b>2.1</b> Constructing an ANOVA table</a></li>
<li class="chapter" data-level="2.2" data-path="eg-1.html"><a href="eg-1.html#testing-for-the-significance-of-the-regression-model"><i class="fa fa-check"></i><b>2.2</b> Testing for the significance of the regression model</a></li>
<li class="chapter" data-level="2.3" data-path="eg-1.html"><a href="eg-1.html#computing-r2"><i class="fa fa-check"></i><b>2.3</b> Computing <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ex2.html"><a href="ex2.html"><i class="fa fa-check"></i><b>3</b> Exercise 1: <code>HSwrestler</code> dataset</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ex2.html"><a href="ex2.html#constructing-an-anova-table-and-testing-for-the-significance-of-the-regression-model."><i class="fa fa-check"></i><b>3.1</b> Constructing an ANOVA table and testing for the significance of the regression model.</a></li>
<li class="chapter" data-level="3.2" data-path="ex2.html"><a href="ex2.html#computing-r2-1"><i class="fa fa-check"></i><b>3.2</b> Computing <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">S2Y Lab 7<br />
Examining model fit – ANOVA and <span class="math inline">\(R^2\)</span></div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eg-1" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Example 1: <code>GRADES</code> dataset<a href="eg-1.html#eg-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Recall the <code>GRADES</code> dataset we explored in Labs 4 and 6. Previously we built a simple linear regression model between GPA and SAT scores and verified the usefulness of SAT in predicting GPA using a <span class="math inline">\(t\)</span>-test. Today, we will look at the ANOVA table produced in <code>R</code>, test the significance of the regression model using an <span class="math inline">\(F\)</span>-test, and finally examine the <span class="math inline">\(R^2\)</span> to understand how well the model performs.</p>
<p>To open the data, type:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="eg-1.html#cb4-1" tabindex="-1"></a><span class="fu">library</span>(PASWR2)</span>
<span id="cb4-2"><a href="eg-1.html#cb4-2" tabindex="-1"></a><span class="fu">data</span>(GRADES)</span></code></pre></div>
<div id="constructing-an-anova-table" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Constructing an ANOVA table<a href="eg-1.html#constructing-an-anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let's construct an ANOVA table for the simple linear regression using the data in <code>GRADES</code>. To start, we first fit the model for <code>gpa</code> and <code>sat</code>:</p>
<p align="center">
<code>model.lm &lt;- lm(gpa ~ sat, data = GRADES)</code>
</p>
<p>Then use the <code>anova()</code> command to obtain the ANOVA table:</p>
<p align="center">
<code>anova(model.lm)</code>
</p>
<p>The ANOVA table output is shown below:</p>
<pre><code>## Analysis of Variance Table
## 
## Response: gpa
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## sat         1 40.397  40.397  253.18 &lt; 2.2e-16 ***
## Residuals 198 31.592   0.160                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Check if you understand everything produced in the above table. If not, ask for help!</p>
</div>
<div id="testing-for-the-significance-of-the-regression-model" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Testing for the significance of the regression model<a href="eg-1.html#testing-for-the-significance-of-the-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <span class="math inline">\(F\)</span>-test is used to assess if the model of interest is useful or not. In this example, since there is only one predictor, testing the significance of the model is equivalent to testing the significance of the predictor. Therefore, we would expect the conclusion from the <span class="math inline">\(F\)</span>-test to be same with that from the <span class="math inline">\(t\)</span>-test in Lab 6. Let's check.</p>
<p><strong>TASK</strong>: Test if the regression model is significant at the <span class="math inline">\(\alpha=0.05\)</span> significance level.</p>
<p><strong>Step 1: Hypotheses</strong></p>
<p>The null and alternative hypotheses for testing the significance of the regression model are:
<span class="math display">\[H_0: \beta_1 = 0\quad \text{ versus }\quad H_1: \beta_1 \neq 0\]</span>
(Unsurprisingly, the hypotheses are identical to those in Example 1 of Lab 6, as there is only one predictor.)</p>
<p><strong>Step 2: Test statistic</strong></p>
<p>Looking at the ANOVA table above, what is the value of test statistic for this problem?</p>
<p><span class="math inline">\(F_\text{obs}=\)</span> <input class='webex-solveme nospaces' size='8' data-answer='["253.1824","253.182","253.18","253.2"]'/></p>
<div class="webex-solution">
<button>
Solution
</button>
<p><span class="math inline">\(F_\text{obs}\)</span> corresponds to <code>F value</code> in the above ANOVA table. It is calculated as:
<span class="math display">\[F_{obs} = \frac{MSR}{MSE} = \frac{40.3965}{0.1596} = 253.1824\]</span></p>
</div>
<p><strong>Step 3: Rejection region calculation</strong></p>
<p>What is the critical value in this case?</p>
<p>ANSWER <span class="math inline">\(=\)</span> <input class='webex-solveme nospaces' size='8' data-answer='["3.888853","3.88885","3.8889","3.889","3.89"]'/></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>Because <span class="math inline">\(F_\text{obs} \sim F_{1,198}\)</span> and this is a one-tailed test, the rejection region is <span class="math inline">\(F_\text{obs} &gt; F_{0.95;1,198} = 3.888853\)</span> (value found by using the R command below).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="eg-1.html#cb6-1" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.95</span>,<span class="dv">1</span>,<span class="dv">198</span>)</span></code></pre></div>
<pre><code>## [1] 3.888853</code></pre>
</div>
<p><strong>Step 4: Statistical conclusion</strong></p>
<ol style="list-style-type: decimal">
<li><p>From the rejection region, we <select class='webex-select'><option value='blank'></option><option value='answer'>reject</option><option value=''>do not reject</option></select> <span class="math inline">\(H_0\)</span> because <span class="math inline">\(F_{obs}\)</span> is <select class='webex-select'><option value='blank'></option><option value='answer'>lies in</option><option value=''>does not lie in</option></select> the rejection region.</p></li>
<li><p>From the <span class="math inline">\(p\)</span>-value (<code>Pr(&gt;|F|))</code> in the above ANOVA table), we <select class='webex-select'><option value='blank'></option><option value='answer'>reject</option><option value=''>do not reject</option></select> <span class="math inline">\(H_0\)</span> because the value for <code>Pr(&gt;|F|))</code> is <select class='webex-select'><option value='blank'></option><option value=''>greater than</option><option value='answer'>less than</option></select> 0.05.</p></li>
</ol>
<p><strong>Step 5: English conclusion</strong></p>
<p>There is <select class='webex-select'><option value='blank'></option><option value='answer'>sufficient evidence</option><option value=''>insufficient evidence</option></select> that suggests the current regression model is significance, thus there exists a linear relationship exists between first-semester <code>gpa</code> and <code>sat</code> scores.</p>
</div>
<div id="computing-r2" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Computing <span class="math inline">\(R^2\)</span><a href="eg-1.html#computing-r2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <span class="math inline">\(R^2\)</span> metric is a measurement of the proportion of variability captured by the model. It is a helpful tool to assess how well our model fits the data (goodness-of-fit).</p>
<p>Compute <span class="math inline">\(R^2\)</span> based on <code>anova(model.lm)</code> (it should be the same as the value of <code>Multiple R-squared</code> returned in <code>summary(model.lm)</code>).</p>
<p><span class="math inline">\(R^2 =\)</span> <input class='webex-solveme nospaces' size='6' data-answer='["0.5612","0.561","0.56",".5612",".561",".56"]'/></p>
<div class="webex-solution">
<button>
Hint: How to calculate <span class="math inline">\(R^2\)</span>
</button>
<p>The formula for <span class="math inline">\(R^2\)</span> is
<span class="math inline">\(R^2 = 1-\frac{SSE}{SST}\)</span>.</p>
</div>
<div class="webex-solution">
<button>
Solution: <span class="math inline">\(R^2\)</span>
</button>
<p><span class="math inline">\(R^2 = 1-\frac{SSE}{SST} = \frac{31.592}{31.592+40.397} = 0.5612\)</span></p>
</div>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ex2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
