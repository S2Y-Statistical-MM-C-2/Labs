[["index.html", "Lab 3 - Hypothesis testing for variance, proportion and goodness-of-fit 1 Welcome to Lab 3 1.1 A summary of the type of the hypothesis test and R commands used today", " Lab 3 - Hypothesis testing for variance, proportion and goodness-of-fit 1 Welcome to Lab 3 Intended Learning Outcomes: Perform hypothesis test for various scenarios manually. Conduct a hypothesis test for the population variance in R with a step-by-step guide. 1.1 A summary of the type of the hypothesis test and R commands used today Test for population variance The \\(F\\)-test can be implemented in R by using var.test: var.test(x, y, ratio = 1, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;), conf.level = 0.95) ratio: the hypothesised ratio of the population variances of \\(X\\) and \\(Y\\), i.e. \\(\\frac{\\sigma_X^2}{\\sigma_Y^2}\\) under \\(H_0\\) alternative: the type of alternative hypothesis, where two.sided corresponds to \\(\\sigma_X^2 \\neq \\sigma_Y^2\\), greater corresponds to \\(\\sigma_X^2 &gt; \\sigma_Y^2\\), and less corresponds to \\(\\sigma_X^2 &lt; \\sigma_Y^2\\). conf.level: confidence level, which equals to \\(1-\\alpha\\) (significance level). "],["written-tasks.html", "2 Written Tasks 2.1 Question 1 2.2 Question 2", " 2 Written Tasks 2.1 Question 1 A pasta company wants to determine whether the average weight of macaroni in their one-pound boxes is equal to 454 grams (1 pound \\(\\approx\\) 454 grams). A sample of 14 boxes is selected, and their weights (in grams) are recorded as follows: State the assumptions that need to be verified before conducting a hypothesis test to answer the company's question. Assuming the necessary assumptions are met, perform the appropriate hypothesis test at a significance level of 10%. Some summary statistics are provided below: \\[\\text{sample mean: } 459.21, \\quad \\text{sample variance: } 11.57\\] Describe the steps to compute the power of the hypothesis test when the true mean weight is 453.592 grams, assuming the true variance of the box weights is 12. Your description should clearly state the test statistic, its associated parameters (e.g. degrees of freedom for a \\(t\\)-distributed random variable), and the critical values. The exact numerical value of the power is not required. 2.2 Question 2 In a packing plant, a machine packs cartons with jars. It is supposed that a new machine will pack faster on the average than the machine currently used. To test that hypothesis, the times it takes each machine to pack ten cartons are recorded (in seconds). The results, as well as the sample mean (\\(\\bar{\\cdot}\\)) and sample standard deviation (\\(s_\\cdot\\)), are shown in the tables below. The figures below show the boxplots and normal quantile-quantile (Q-Q plot) for the new and old machines. Comment on the suitability of a normal model for data on the new machine and old machine. Perform a hypothesis test to determine whether the new machine will pack faster on the average than the machine currently used using a significance level of 5%. Solution will be available on Moodle after Wednesday 4pm. "],["example-1-diode-diameter-hypothesis-test.html", "3 Example 1: Diode Diameter Hypothesis Test 3.1 Verifying normality 3.2 Step 1 - Hypotheses 3.3 Step 2 - Test Statistic 3.4 Step 3 - Hypothesis Test Calculations 3.5 Step 4 - Statistical Conclusion 3.6 Step 5 - English Conclusion", " 3 Example 1: Diode Diameter Hypothesis Test In the construction of a safety strobe, a particular manufacturer can purchase LED diodes from one of two suppliers. It is critical that the purchased diodes conform to their stated specifications with respect to diameter since they must be mated with a fixed width cable. The diameter in millimeters for a random sample of 15 diodes from each of the two suppliers was taken. The diameters can be found in the LEDDIODE data frame in the PASWR2 package. Question of interest: Does this data provide evidence to suggest a difference in variabilities between the two suppliers? Use a significance level of \\(\\alpha = 0.01\\) for any tests. Reminder of how to access data Install or load the package and then save the data to your environment. E.g: library(PASWR2) LEDDIODE &lt;- LEDDIODE 3.1 Verifying normality Before we start, let's note that this test is to compare variances of two unpaired samples. This means the type of test we will use is an \\(F\\)-test. As always, we should start by verifying the normality assumption required for this test. We should do this with ggplot: ggplot(data = LEDDIODE, aes(diameter, fill = supplier)) + geom_density(alpha = 0.3) + xlim(min(density.default(x = LEDDIODE$diameter)$x), max(density.default(x = LEDDIODE$diameter)$x)) + theme_bw() ggplot(data = LEDDIODE, aes(sample = diameter, color = supplier)) + stat_qq() + theme_bw() Based on the density plots and quantile-quantile normal plots, it seems reasonable to assume the LED diode widths from both suppliers follow normal distributions. Therefore, proceed with the five-step procedure. 3.2 Step 1 - Hypotheses Hypotheses — The null and alternative hypotheses to test whether the variability in LED diode widths using supplier A’s (X) diodes is not equal to the variability in LED diode widths using supplier B’s (Y) diodes are: \\[H_0 : \\sigma^2_X = \\sigma_Y^2 \\quad \\text{versus} \\quad H_1 : \\sigma^2_X \\neq \\sigma_Y^2\\] 3.3 Step 2 - Test Statistic The test statistics chosen are \\(S^2_X\\) and \\(S^2_Y\\) since \\(E[S^2_X] = \\sigma^2_X\\) and \\(E[S^2_Y] = \\sigma^2_Y\\). VAR &lt;- tapply(LEDDIODE$diameter, LEDDIODE$supplier, var) VAR ## supplierA supplierB ## 0.06495524 0.01506381 The value of the test statistics are \\(s^2_X = 0.0650\\) and \\(s^2_Y = 0.0151\\). We will determine the probability of obtaining this test statistic when the null hypothesis is true. We do this with standardisation and the probability is called the \\(p\\)-value. The standardised test statistic is calculated under the assumption that \\(H_0\\) is true and its distribution for this test are \\[\\frac{S^2_X}{S^2_Y} \\sim F_{15−1, 15-1}\\] This is what will be used to complete the test. 3.4 Step 3 - Hypothesis Test Calculations 3.4.1 Finding the rejection region Before we continue to analyse our data we must find the rejection region: Because the standardised test statistic is distributed \\(F_{14,14}\\), and \\(H_1\\) is a two-sided hypothesis, the rejection region is \\(f_{obs} &lt; F_{0.005;14,14}\\) or \\(f_{obs} &gt; F_{0.995;14,14}\\) From the statistical tables or from R, the \\(F\\)-values that correspond to the significance level (critical values) are \\(F_{0.005;14,14} = 0.2326\\) and \\(F_{0.995;14,14} = 4.2993\\). RRupper &lt;- qf(0.995, 14, 14) RRlower &lt;- qf(0.005, 14, 14) c(RRlower, RRupper) ## [1] 0.2325967 4.2992869 This gives us the critical values which make up the limits of the rejection region (what we will compare our result to). Remember you can sketch these if it helps to see the rejection region graphically. 3.4.2 Finding the standardised test statistic and \\(p\\)-value The test we are running here is an \\(F\\) test on variances. We can calculate the standardised test statistics by hand or with R. In R: f_obs &lt;- VAR[1]/VAR[2] f_obs ## supplierA ## 4.312006 This gives our standardised test statistic as \\(f_{obs} = \\frac{s^2_X}{s^2_Y}= \\frac{0.065}{0.0151} = 4.312\\) and the corresponding \\(p\\)-value \\(2*\\mathrm{P}(F_{14,14} \\geq 4.312) = 0.0099\\). 2*pf(f_obs, 14, 14, lower=FALSE) ## supplierA ## 0.009861004 R also has a built-in function, var.test to perform the \\(F\\)-test of equality of variances, which automatically return the value of standardised test statistic and \\(p\\)-value. TR &lt;- var.test(diameter ~ supplier, data = LEDDIODE, conf.level = 0.99) TR ## ## F test to compare two variances ## ## data: diameter by supplier ## F = 4.312, num df = 14, denom df = 14, p-value = 0.009861 ## alternative hypothesis: true ratio of variances is not equal to 1 ## 99 percent confidence interval: ## 1.002958 18.538551 ## sample estimates: ## ratio of variances ## 4.312006 3.5 Step 4 - Statistical Conclusion To draw our conclusions we need to consider our rejection region. Remember this is both ends of the F-distribution for this two-sided test. QUESTION: Do we reject our null hypothesis? Solution I. From the rejection region, we reject \\(H_0\\) because \\(f_{obs} = 4.312\\) is greater than 4.2993 and is inside the rejection region (in its upper tail). OR From the \\(p\\)-value, we reject \\(H_0\\) because the \\(p\\)-value \\(0.0099 &lt; 0.01\\). Whichever method we use, we reject \\(H_0\\). 3.6 Step 5 - English Conclusion What does the previous statistical conclusion mean for the data and the purpose of the test? QUESTION: Which of the following is the correct conclusion of our test? There is evidence to suggest the variability of the width of LED diodes from supplier A is not equal to the variance for the width of LED diodes from supplier B. There is evidence to suggest the variability of the width of LED diodes from supplier A is equal to the variance for the width of LED diodes from supplier B. There is insufficient evidence to suggest the variability of the width of LED diodes from supplier A is equal to the variance for the width of LED diodes from supplier B. We cannot conclude if there is sufficient evidence to suggest the variability of the width of LED diodes from supplier A is not equal to the variance for the width of LED diodes from supplier B. "],["example-2-vitoria-apartment-costs.html", "4 Example 2: Vitoria Apartment Costs 4.1 Verifying normality 4.2 Step 1 - Hypotheses 4.3 Step 2 - Choosing a Test Statistic 4.4 Step 3 - Hypothesis Test Calculations 4.5 Step 4 - Statistical Conclusion 4.6 Step 5 - English Conclusion", " 4 Example 2: Vitoria Apartment Costs An apartment appraiser in Vitoria, Spain, feels confident in his appraisals of \\(90m^2\\) or larger pisos (apartments) provided his variability is less than \\(60,000^2\\text{€}^2\\). Due to constant movement in the housing market, the regional housing authority suspects the appraiser’s variability may be greater than \\(60,000^2\\text{€}^2\\). The appraised values of apartments in Vitoria are stored in the variable totalprice of the VIT2005 data frame in the PASWR2 package. Question of interest: Is there evidence to support the suspicions of the regional housing authority? Test the appropriate hypothesis at the 5% significance level. 4.1 Verifying normality To solve this problem, start by selecting the data we are interested in and then verify the reasonableness of the normality assumption. Greater90 &lt;- subset(x = VIT2005, subset = area &gt;= 90) with(data = Greater90, eda(totalprice)) ## Size (n) Missing Minimum 1st Qu Mean Median ## 9.400000e+01 0.000000e+00 1.780000e+05 2.922500e+05 3.358840e+05 3.335000e+05 ## TrMean 3rd Qu Max Stdev Var SE Mean ## 3.347802e+05 3.730000e+05 5.600000e+05 6.183026e+04 3.822981e+09 6.377304e+03 ## I.Q.R. Range Kurtosis Skewness SW p-val ## 8.075000e+04 3.820000e+05 1.101000e+00 4.330000e-01 1.250000e-01 The results from applying eda(), suggest the appraised price for \\(90m^2\\) or larger pisos follows a normal distribution. Now, continue with the five-step procedure. 4.2 Step 1 - Hypotheses Hypotheses — The null and alternative hypotheses to test whether the variability in price for \\(90m^2\\) or larger pisos is greater than \\(60,000^2\\text{€}^2\\), are \\[H_0 : \\sigma^2 = 60,000^2 \\quad \\text{versus} \\quad H_1 : \\sigma^2 &gt; 60,000^2 \\] Learn More This is a one-tail test as as we want to know if the variability in price of pisos that are \\(90m^2\\) or larger is in fact \\(60,000^2\\text{€}^2\\) or if it is greater than that. Two-tailed would test for any difference from \\(60,000^2\\text{€}^2\\) not just greater than. 4.3 Step 2 - Choosing a Test Statistic The test statistic chosen is \\(S^2\\) because \\(E[S^2] = \\sigma^2\\). TS &lt;- var(Greater90$totalprice) TS ## [1] 3822980710 The value of this test statistic is \\(s^2=3822980710\\). The standardised test statistic under the assumption that \\(H_0\\) is true and its approximate distribution are: \\[ \\frac{(n-1)S^2}{\\sigma^2_0}\\quad \\sim \\quad \\chi^2_{n-1},\\] where \\(n\\) denotes the sample size and \\(\\sigma_0^2=60000^2\\) in this case. This is what will be used to complete the test. 4.4 Step 3 - Hypothesis Test Calculations 4.4.1 Finding the rejection region In this dataset, \\(n = 94\\) (which can be seen from Size (n) in the summary statistics above), so the standardised test statistic is distributed \\(\\chi^2_{93}\\). Moreover, since \\(H_1\\) is an upper one-sided hypothesis, the rejection region is the \\(\\chi^2_{obs} &gt; \\chi^2_{0.95;93}\\) Using R code or the statistical tables, the \\(t\\)-value that corresponds to our significance level (critical value) is \\(\\chi^2_{0.95;93} = 116.511\\). n &lt;- nrow(Greater90) RR &lt;- qchisq(0.95, n-1) RR ## [1] 116.511 This gives us the critical value and the significance level which make up the rejection region (what we will compare our result to). Remember sketching or graphing the \\(\\chi^2\\) distribution and regions might help. Rejection Regions The rejection region is the area in which we would reject the null hypothesis. The critical value is the \\(t\\) value that corresponds to the significance level of 0.05, and hence is the bottom limit of our rejection region. The probability of observing our test statistic (sample variance) or more extreme values under the null hypothesis is the \\(p\\)-value. To reject a null hypothesis in this case we need the standardisd test statistic to be greater than the critical value and hence our \\(p\\)-value &lt; 0.05. 4.4.2 Finding the standardised test statistic and \\(p\\)-value The value of the standardised test statistic is given by \\(\\chi^2_{obs}\\) = \\(\\frac{(n-1)s^2}{\\sigma^2_0} = \\frac{(94-1)*3822980710}{60,000^2} = 98.7603\\). STS &lt;- (n - 1)*TS/60000^2 STS ## [1] 98.76034 We should use R to find the corresponding \\(p\\)-value \\(\\mathrm{P}(\\chi^2_{93} \\geq 98.7603)\\). pvalue &lt;- pchisq(STS, n-1, lower = FALSE) pvalue ## [1] 0.3218218 The \\(p\\)-value is equal to \\(0.3218\\) in this case. Learn More You may want to sketch or plot this test graphically if you need help make a visual comparison between the value of test statistic and the rejection region we found above. 4.5 Step 4 - Statistical Conclusion To draw our conclusions we need to consider our rejection region. Remember this is at the upper end of the \\(\\chi^2\\)-distribution for this one-sided test. QUESTION: Do we reject the null hypothesis? Solution I. From the rejection region, we fail to reject \\(H_0\\) because the standardised test statistic is less than the critical value and hence is not in the rejection region, i.e. \\(\\chi^2_{obs} = 98.7603 &lt; 116.511\\). OR From the \\(p\\)-value, we fail to reject \\(H_0\\) because the \\(p\\)-value \\(0.3218 &gt; 0.05\\). Whichever method we use, we fail to reject \\(H_0\\). 4.6 Step 5 - English Conclusion What does the previous statistical conclusion mean for the data and the purpose of the test? Is there statistical evidence to suggest the variance for the appraised price of \\(90m^2\\) or larger pisos is greater than \\(60,000^2\\text{€}^2\\)? QUESTION: Which of the following is the correct conclusion of our test? There is evidence to suggest the variance for the appraised price of 90 meteres squared or larger pisos is greater than 3.6 billion Euros squared. There is insufficient evidence to suggest the variance for the appraised price of 90 meteres squared or larger pisos is greater than 3.6 billion Euros squared. There is sufficient evidence to suggest the variance for the appraised price of 90 meteres squared or larger pisos is less than 3.6 billion Euros squared. We cannot conclude if there is sufficient evidence to suggest the variance for the appraised price of 90 meteres squared or larger pisos is greater than 3.6 billion Euros squared. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
