<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 6 - Hypothesis testing and interval estimation</title>
  <meta name="description" content="Lab 6 - Hypothesis testing and interval estimation" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 6 - Hypothesis testing and interval estimation" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 6 - Hypothesis testing and interval estimation" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="#welcome-to-lab-6"><i class="fa fa-check"></i><b>1</b> Welcome to Lab 6</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab 6 - Hypothesis testing and interval estimation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Lab 6 - Hypothesis testing and interval estimation</h1>
</div>
<div id="welcome-to-lab-6" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Welcome to Lab 6<a href="#welcome-to-lab-6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Intended Learning Outcomes:</strong></p>
<ul>
<li><p>use <code>R</code> to conduct hypothesis tests for parameters in a linear model;</p></li>
<li><p>use various summary statistics and <code>R</code> output to compute confidence and prediction intervals;</p></li>
<li><p>use the built-in <code>R</code> function to compute confidence and prediction intervals;</p></li>
<li><p>interpret hypothesis tests, confidence intervals and prediction intervals.</p></li>
</ul>
<!-- ## The `summary()` function for regression models -->
<!-- Before discussing hypothesis testing and confidence intervals for regression models, let's first revise the output of `summary()` function. -->
<!-- Recall the model we created in Lab 4, where we try to predict the hydrostatic fat measurement of a wrestler from abomnimal fat and tricep fat measurements. -->
<!-- ```{r} -->
<!-- library(PASWR) -->
<!-- HSWRESTLER <- HSwrestler -->
<!-- Model1 <- lm(HWFAT ~ ABS + TRICEPS, data = HSWRESTLER) -->
<!-- ``` -->
<!-- We apply the summary function, which gives the following output: -->
<!-- ```{r} -->
<!-- summary(Model1) -->
<!-- ``` -->
<!-- The above `R` output displays a few elements, which were briefly explained below. -->
<!-- **Call**: This shows the formula that was used in the regression model. -->
<!-- **Residuals**: This lists the five-number summary of the residuals from the regression model. -->
<!-- **Coefficients**: This shows a summary of estimated coefficients of the regression model. -->
<!-- Within this section the column headers are: -->
<!-- * **Estimate**: The estimated parameter. These can be used to write down the fitted regression model. -->
<!-- * **Std. Error**: This is the estimated standard error of the parameter estimate. -->
<!-- * **t value**: This is the $t$-statistic for the parameter, calculated as `Estimate` / `Std. Error`. -->
<!-- * **Pr(>|t|)**: This is the $p$-value that corresponds to the $t$-statistic, i.e. $2\cdot \mathbb{P}(X>|t|)$ for $X \sim t(n-p)$, where $t$ is the `t value` computed above, $n$ is the sample size, and $p$ is the number of parameters. -->
<!-- **Significance codes**: These codes in asterisks are appended to the $p$-values in regression analysis results. They provide a quick indication of the level of significance of the predictors in the model. The most commonly used significance levels and their corresponding codes are: -->
<!-- ```{r echo=FALSE} -->
<!-- significance <- data.frame( -->
<!--   significance_code = c("***", "**", "*", ".", ""), -->
<!--   p_value = c("< 0.001", "0.001 - 0.01", "0.01 - 0.05", "0.05 - 0.1", "â‰¥ 0.1")) -->
<!-- colnames(significance) <- c("significance code", "p-value") -->
<!-- kable(significance, align = c("c", "r")) -->
<!-- ``` -->
<!-- **Residual standard error**: This is the square root of mean squared error (MSE), where $MSE=\frac{\sum_{i=1}^n \epsilon_i^2}{n-p}$ is calculated as the sum of squared residuals divided by the degrees of freedom in the model. -->
<!-- The remaining terms, `Multiple R-squared`, `Adjusted R-squared` and `F-statistic`, will be explained in subsequent labs.  -->
<!-- Here we can look at the estimates of the model coefficients \(\hat{\beta}_k\), which are both positive, indicating both `Abs` and `Tri` have a positive relationship with Hydrostatic fat.  -->
<!-- We can also state that both Abdominal Fat and Tricep Fat measurements are significant in predicting the Hydrostatic fat measurement to a significance level of \(\approx 0\) by looking at the $p$-values associated with the $t$-tests. -->
<!-- ## Hypothesis testing for linear relationships -->
<!-- Recall a linear regression model can be written in the matrix form as  -->
<!-- $$\mathbf{Y} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol \epsilon.$$ -->
<!-- Assuming \(\boldsymbol{\epsilon} \sim N (\mathbf{0},\sigma^2 \bf{I})\), we have shown that \(\mathbf{Y} \sim N (\mathbf{X} \boldsymbol{\beta},\sigma^2 \bf{I})\)  and \(\hat{\boldsymbol{\beta}} \sim N (\boldsymbol{\beta},\sigma^2 \mathbf{(X'X)}^{-1})\). -->
<!-- ### Finding the estimate of error variance -->
<!-- We know that \(\hat{\sigma}^2 = s^2=MSE=\frac{SSE}{n-p}=\frac{\sum^2_{i=1} \hat{\epsilon}^2_i}{n-p}\) and  -->
<!-- $$\mathbf{s}^2_{{\hat{\boldsymbol{\beta}}}} = \hat{\sigma}^2 \mathbf{(X'X)}^{-1} = \begin{bmatrix} -->
<!-- s^2_{{\hat{\beta}_0}} & s_{\hat{\beta}_0,\hat{\beta}_1} &...& s_{\hat{\beta}_0,\hat{\beta}_{p-1}}\\ -->
<!-- s_{\hat{\beta}_1,\hat{\beta}_0} & s^2_{\hat{\beta}_1} &...& s_{\hat{\beta}_1,\hat{\beta}_{p-1}}\\ -->
<!-- \vdots & \vdots & \ddots & \vdots \\ -->
<!-- s_{\hat{\beta}_{p-1},\hat{\beta}_0} & s_{\hat{\beta}_{p-1},\hat{\beta}_1} &...& s^2_{\hat{\beta}_{p-1}} -->
<!-- \end{bmatrix} $$ -->
<!-- In R the matrices of $\mathbf{(X'X)}^{-1}$ and $\mathbf{s}^2_{{\hat{\boldsymbol{\beta}}}}$ can be found using `summary(lm.object)$cov.unscaled` and `vcov(lm.object)` respectively, where `lm.object` is the linear model object built by using `lm()`. -->
<!-- ### Steps of the hypothesis test -->
<!-- **Step 1: Hypotheses**  -->
<!-- If we want to test a model coefficient against a hypothesised value. the null and alternative hypotheses are: -->
<!-- $$H_0: \beta_k = \beta_{k_0} \quad \text{vs} \quad H_1: \beta_k \neq \beta_{k_0}$$ -->
<!-- **Step 2: Test Statistic**  -->
<!-- The test statistic is \(\hat{\beta_k}\). Assuming the error terms are distributed normally,  -->
<!-- $$\hat{\beta_k} \sim N(\beta_k, \sigma^2_{\hat{\beta_k}}).$$ -->
<!-- The standardised test statistic under the assumption that $H_0$ is true and its distribution are: -->
<!-- \[\frac{\text{unbiased estimator} - \text{hypothesized value}}{\text{standard error of estimator}} = \frac{\hat{\beta}_k-\beta_{k_0}}{s_{\hat{\beta}_k}} \sim t_{n-p}\] -->
<!-- **Step 3: Rejection region calculations**  -->
<!-- The standardised test statistic is $\frac{\hat{\beta_k}-\beta_{k_0}}{s_{\hat{\beta}_k}} \sim t_{n-p}$, and so $t_\text{obs} = \frac{\hat{\beta_k}-\beta_{k_0}}{s_{\hat{\beta}_k}}$. This can be compared to the critical value, \(t_{1-\alpha,n-p}\), which can be found from the statistical table or using R.  -->
<!-- In R the test can be run using the function `lm()`. For example: -->
<!-- ```{r, echo=TRUE, eval=FALSE} -->
<!-- model <- lm() -->
<!-- summary(model)$coef -->
<!-- ``` -->
<!-- This will give the observed $t$-value and the corresponding $p$-value which can then be compared to the significance level \(\alpha\). -->
<!-- **Step 4: Statistical conclusion** -->
<!-- * From the rejection region, reject $H_0$ if $|t_\text{obs}$ is greater than the critical value. -->
<!-- * From the $p$-value, reject $H_0$ if the $p$-value is less than \(\alpha\). -->
<!-- **Step 5: English conclusion**  -->
<!-- Depending on whether $H_0$ is rejected or not, conclude whether there is sufficient or insufficient evidence evidence to suggest a linear relationship between the response variable and the predictor variable.  -->
<!-- ## Confidence intervals for the model parameters -->
<!-- We may also want to build confidence intervals (CI) for our model parameters. The CI for the parameter \(\beta_k\) with confidence level \(1-\alpha\) is: -->
<!-- \[\left( \hat{\beta}_k - t_{1-\alpha/2\text{ };\text{ }n-p} \cdot s_{\hat{\beta}_k},\ \hat{\beta}_k + t_{1-\alpha/2\text{ };\text{ }n-p} \cdot s_{\hat{\beta}_k}\right),\] -->
<!-- where the degrees of freedom is \(n-p\) because \(\sigma^2\) is estimated using \(MSE=\frac{SSE}{n-p}\).  -->

</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

</body>

</html>
