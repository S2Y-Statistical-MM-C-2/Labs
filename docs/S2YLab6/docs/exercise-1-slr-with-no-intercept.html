<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Exercise 1: SLR with no intercept | Lab 6 - Ordinary least squares</title>
  <meta name="description" content="3 Exercise 1: SLR with no intercept | Lab 6 - Ordinary least squares" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Exercise 1: SLR with no intercept | Lab 6 - Ordinary least squares" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Exercise 1: SLR with no intercept | Lab 6 - Ordinary least squares" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example-1-crime.html"/>
<link rel="next" href="exercise-2-quadratic-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to Lab 6!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction-to-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>1.1</b> Introduction to Ordinary Least Squares (OLS)</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-simplest-regression-model-simple-linear-regression-one-covariate"><i class="fa fa-check"></i><b>1.2</b> The simplest regression model: simple linear regression (one covariate)</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-next-simplest-regression-model-multiple-linear-regression-multiple-predictors"><i class="fa fa-check"></i><b>1.3</b> The next-simplest regression model: multiple linear regression (multiple predictors)</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#ordinary-least-squares"><i class="fa fa-check"></i><b>1.4</b> Ordinary least squares</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-1-crime.html"><a href="example-1-crime.html"><i class="fa fa-check"></i><b>2</b> Example 1: Crime</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-1-crime.html"><a href="example-1-crime.html#simple-linear-regression"><i class="fa fa-check"></i><b>2.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="example-1-crime.html"><a href="example-1-crime.html#least-squares-estimates-of-model-parameters-in-matrix-notation"><i class="fa fa-check"></i><b>2.1.1</b> Least squares estimates of model parameters in matrix notation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="example-1-crime.html"><a href="example-1-crime.html#multiple-linear-regression"><i class="fa fa-check"></i><b>2.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exercise-1-slr-with-no-intercept.html"><a href="exercise-1-slr-with-no-intercept.html"><i class="fa fa-check"></i><b>3</b> Exercise 1: SLR with no intercept</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exercise-1-slr-with-no-intercept.html"><a href="exercise-1-slr-with-no-intercept.html#exploratory-analysis"><i class="fa fa-check"></i><b>3.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="3.2" data-path="exercise-1-slr-with-no-intercept.html"><a href="exercise-1-slr-with-no-intercept.html#fitting-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>3.2</b> Fitting a simple linear regression model</a></li>
<li class="chapter" data-level="3.3" data-path="exercise-1-slr-with-no-intercept.html"><a href="exercise-1-slr-with-no-intercept.html#fitting-a-linear-model-with-no-intercept"><i class="fa fa-check"></i><b>3.3</b> Fitting a linear model with no intercept</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exercise-2-quadratic-regression.html"><a href="exercise-2-quadratic-regression.html"><i class="fa fa-check"></i><b>4</b> Exercise 2: Quadratic regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exercise-2-quadratic-regression.html"><a href="exercise-2-quadratic-regression.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>4.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="4.2" data-path="exercise-2-quadratic-regression.html"><a href="exercise-2-quadratic-regression.html#fitting-a-quadratic-regression-model"><i class="fa fa-check"></i><b>4.2</b> Fitting a quadratic regression model</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-3-the-taste-of-cheese.html"><a href="exercise-3-the-taste-of-cheese.html"><i class="fa fa-check"></i><b>5</b> Exercise 3: The taste of cheese</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exercise-3-the-taste-of-cheese.html"><a href="exercise-3-the-taste-of-cheese.html#exploratory-analysis-2"><i class="fa fa-check"></i><b>5.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="5.2" data-path="exercise-3-the-taste-of-cheese.html"><a href="exercise-3-the-taste-of-cheese.html#fitting-a-model-with-a-transformation"><i class="fa fa-check"></i><b>5.2</b> Fitting a model with a transformation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="written-questions.html"><a href="written-questions.html"><i class="fa fa-check"></i><b>6</b> Written questions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="written-questions.html"><a href="written-questions.html#question-1"><i class="fa fa-check"></i><b>6.1</b> Question 1</a></li>
<li class="chapter" data-level="6.2" data-path="written-questions.html"><a href="written-questions.html#question-2"><i class="fa fa-check"></i><b>6.2</b> Question 2</a></li>
<li class="chapter" data-level="6.3" data-path="written-questions.html"><a href="written-questions.html#question-3"><i class="fa fa-check"></i><b>6.3</b> Question 3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab 6 - Ordinary least squares</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-1-slr-with-no-intercept" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Exercise 1: SLR with no intercept<a href="exercise-1-slr-with-no-intercept.html#exercise-1-slr-with-no-intercept" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducing-the-data-hubbles-constant" class="section level4 unnumbered hasAnchor">
<h4>Introducing the data: Hubble's Constant<a href="exercise-1-slr-with-no-intercept.html#introducing-the-data-hubbles-constant" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Source:</strong> Hubble, E. (1929) A Relationship Between Distance and Radial Velocity among Extra-Galactic Nebulae, Proceedings of the National Academy of Science, 168.</p>
<p><strong>Context:</strong> In 1929 Edwin Hubble investigated the relationship between distance and radial velocity of extragalactic nebulae (celestial objects). It was hoped that some knowledge of this relationship might give clues as to the way the universe was formed and what may happen later. His findings revolutionised astronomy and are the source of much research today on the ‘Big Bang’. Given here is the data that Hubble used for 24 nebulae. It is of interest to determine the effect of distance on velocity.</p>
<p><strong>Data:</strong> <code>hubble.csv</code></p>
<p><strong>Columns:</strong></p>
<div class="line-block">                      <strong>C1:</strong> <code>Distance</code> - (in Megaparsecs) from Earth</div>
<div class="line-block">                      <strong>C2:</strong> <code>Velocity</code> - recession (in km/sec)</div>
<p>Read in the data using:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="exercise-1-slr-with-no-intercept.html#cb10-1" tabindex="-1"></a>hubble <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;hubble.csv&quot;</span>)</span></code></pre></div>
<p><br></p>
</div>
<div id="exploratory-analysis" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Exploratory analysis<a href="exercise-1-slr-with-no-intercept.html#exploratory-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>TASK 2</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Produce a scatterplot of the data with <code>Velocity</code> on the y-axis.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exercise-1-slr-with-no-intercept.html#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(Velocity <span class="sc">~</span> Distance, <span class="at">data =</span> hubble, <span class="at">xlab=</span><span class="st">&quot;Distance&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Velocity&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Describe the shape of the relationship.</li>
</ol>
<p>The relationship appears to be <select class='webex-select'><option value='blank'></option><option value=''>non-linear</option><option value='answer'>linear</option></select> and it <select class='webex-select'><option value='blank'></option><option value='answer'>seems plausible</option><option value=''>does not seem plausible</option></select> that the line passes through the origin.</p>
<p><br></p>
</div>
<div id="fitting-a-simple-linear-regression-model" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Fitting a simple linear regression model<a href="exercise-1-slr-with-no-intercept.html#fitting-a-simple-linear-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol start="3" style="list-style-type: lower-alpha">
<li>Fit a simple linear regression model with the response variable <code>Velocity</code> and the explanatory variable
<code>Distance</code> and write down the equation of the fitted line.</li>
</ol>
<p>The equation of the fitted line is given by:</p>
<center>
<code>Velocity</code> = <input class='webex-solveme nospaces' size='9' data-answer='["-40.78365","-40.7837","-40.784","-40.78","-40.8"]'/> <strong>+</strong> <input class='webex-solveme nospaces' size='9' data-answer='["454.15844","454.1584","454.158","454.16","454.2"]'/> <code>Distance</code>
</center>
<p>This is the line of best fit, describing the effect of distance on velocity.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Produce a plot of the data including the fitted line.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>A fitted line can be added to a plot using the command <code>abline</code>.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exercise-1-slr-with-no-intercept.html#cb12-1" tabindex="-1"></a>model_hubble <span class="ot">&lt;-</span> <span class="fu">lm</span>(Velocity <span class="sc">~</span> Distance, <span class="at">data =</span> hubble)</span>
<span id="cb12-2"><a href="exercise-1-slr-with-no-intercept.html#cb12-2" tabindex="-1"></a><span class="fu">plot</span>(Velocity <span class="sc">~</span> Distance, <span class="at">data =</span> hubble)</span>
<span id="cb12-3"><a href="exercise-1-slr-with-no-intercept.html#cb12-3" tabindex="-1"></a><span class="fu">abline</span>(model_hubble)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="now-with-ols" class="section level4 unnumbered hasAnchor">
<h4>Now with OLS<a href="exercise-1-slr-with-no-intercept.html#now-with-ols" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="5" style="list-style-type: lower-alpha">
<li>Fit a simple linear regression model with the response variable <code>Velocity</code> and the explanatory variable <code>Distance</code> and provide parameter estimates using the matrix formula of least squares estimation.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p><span class="math inline">\(\hat{\boldsymbol{\beta}}=(\mathbf{X}&#39;\mathbf{X})^{-1} \mathbf{X}&#39;\mathbf{Y}\)</span></p>
</div>
<div class="webex-solution">
<button>
Hint
</button>
<p><code>X &lt;- model.matrix(~ Distance, data = hubble)</code></p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exercise-1-slr-with-no-intercept.html#cb13-1" tabindex="-1"></a><span class="co"># Define X</span></span>
<span id="cb13-2"><a href="exercise-1-slr-with-no-intercept.html#cb13-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> Distance, <span class="at">data =</span> hubble)</span>
<span id="cb13-3"><a href="exercise-1-slr-with-no-intercept.html#cb13-3" tabindex="-1"></a><span class="co"># Obtain XtX</span></span>
<span id="cb13-4"><a href="exercise-1-slr-with-no-intercept.html#cb13-4" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb13-5"><a href="exercise-1-slr-with-no-intercept.html#cb13-5" tabindex="-1"></a><span class="co"># Take the inverse</span></span>
<span id="cb13-6"><a href="exercise-1-slr-with-no-intercept.html#cb13-6" tabindex="-1"></a>XtX_inv <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX)</span>
<span id="cb13-7"><a href="exercise-1-slr-with-no-intercept.html#cb13-7" tabindex="-1"></a><span class="co"># Define Y</span></span>
<span id="cb13-8"><a href="exercise-1-slr-with-no-intercept.html#cb13-8" tabindex="-1"></a>Y <span class="ot">&lt;-</span> hubble<span class="sc">$</span>Velocity</span>
<span id="cb13-9"><a href="exercise-1-slr-with-no-intercept.html#cb13-9" tabindex="-1"></a><span class="co"># Obtain XtY</span></span>
<span id="cb13-10"><a href="exercise-1-slr-with-no-intercept.html#cb13-10" tabindex="-1"></a>XtY <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> Y</span>
<span id="cb13-11"><a href="exercise-1-slr-with-no-intercept.html#cb13-11" tabindex="-1"></a><span class="co"># Estimate parameters</span></span>
<span id="cb13-12"><a href="exercise-1-slr-with-no-intercept.html#cb13-12" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX) <span class="sc">%*%</span> XtY</span></code></pre></div>
</div>
</div>
</div>
<div id="fitting-a-linear-model-with-no-intercept" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Fitting a linear model with no intercept<a href="exercise-1-slr-with-no-intercept.html#fitting-a-linear-model-with-no-intercept" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From the scatterplot in (a), it is plausible from the data that the regression line should be forced to go through the origin. A model with no intercept could be fitted using:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="exercise-1-slr-with-no-intercept.html#cb14-1" tabindex="-1"></a><span class="fu">lm</span>(Velocity <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> Distance, <span class="at">data =</span> hubble)</span></code></pre></div>
<p>The inclusion of <code>-1</code> is what removes the intercept term from the model fit.</p>
<p>Note down the equation of the fitted line that is given:</p>
<center>
<code>Velocity</code> = <input class='webex-solveme nospaces' size='8' data-answer='["423.9373","423.937","423.94","423.9"]'/> <code>Distance</code>
</center>
<p>If we save the model with and without intercept using</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exercise-1-slr-with-no-intercept.html#cb15-1" tabindex="-1"></a>model.Int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Velocity <span class="sc">~</span> Distance, <span class="at">data =</span> hubble)</span>
<span id="cb15-2"><a href="exercise-1-slr-with-no-intercept.html#cb15-2" tabindex="-1"></a>model.NoInt <span class="ot">&lt;-</span> <span class="fu">lm</span>(Velocity <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> Distance, <span class="at">data =</span> hubble)</span></code></pre></div>
<p>a plot of the data can be re-produced as before with the fitted lines from both linear models added using the command:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="exercise-1-slr-with-no-intercept.html#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(Velocity <span class="sc">~</span> Distance, <span class="at">data =</span> hubble)</span>
<span id="cb16-2"><a href="exercise-1-slr-with-no-intercept.html#cb16-2" tabindex="-1"></a><span class="fu">abline</span>(model.Int, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb16-3"><a href="exercise-1-slr-with-no-intercept.html#cb16-3" tabindex="-1"></a><span class="fu">abline</span>(model.NoInt, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb16-4"><a href="exercise-1-slr-with-no-intercept.html#cb16-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;with intercept&quot;</span>, <span class="st">&quot;w/o intercept&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:hubble-plot"></span>
<img src="main_files/figure-html/hubble-plot-1.png" alt="Scatterplot of `Velocity` versus `Distance` with two fitted models - simple linear regression model with and without the intercept." width="70%" />
<p class="caption">
Figure 3.1: Scatterplot of <code>Velocity</code> versus <code>Distance</code> with two fitted models - simple linear regression model with and without the intercept.
</p>
</div>
<p>The <code>lty</code> argument in <code>abline</code> changes the type/style of the line plotted, which is handy when printing in black and white.</p>
<p>A <code>legend</code> is also added to distinguish between the lines plotted.</p>
<div id="now-with-ols-1" class="section level4 unnumbered hasAnchor">
<h4>Now with OLS<a href="exercise-1-slr-with-no-intercept.html#now-with-ols-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="6" style="list-style-type: lower-alpha">
<li>Fit a simple linear regression model with the response variable <code>Velocity</code> and the explanatory variable <code>Distance</code> but with no intercept. Again use the matrix formula of least squares estimation.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p><code>X &lt;- model.matrix(~ -1 + Distance, data = hubble)</code></p>
</div>
<p><strong>DISCUSSION</strong>: Comparing the two fitted lines, is the model that passes through the origin plausible?</p>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Check Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Check Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="example-1-crime.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-2-quadratic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
