[["index.html", "1 Welcome to S2Y Lab 1 1.1 Summary for testing the mean when sampling from a normal distribution with unknown variance (one-sample \\(t\\)-test) 1.2 Optional: RStudio Quickstart Guide 1.3 Credit where credit is due", " S2Y Lab 1 Exploring Hypothesis Testing 1 Welcome to S2Y Lab 1 Intended Learning Outcomes: Conduct one-sample \\(t\\)-test (testing the mean when sampling from a normal distribution with unknown variance) in R with a step-by-step guide. Conduct one-sample \\(t\\)-test in R with the built-in function. Explore further the significance level and the power of a test. 1.1 Summary for testing the mean when sampling from a normal distribution with unknown variance (one-sample \\(t\\)-test) 1.2 Optional: RStudio Quickstart Guide This course assumes basic knowledge of R and RStudio. The starting point is opening RStudio by going to: Maths &amp; Stats Apps &gt; RStudio To access the data in this course, it is best to open and save a new script file to work in within RStudio and to set the working directory. This will enable you to save your R commands and comments on your work as you go through each of the examples. To open a new script go to: File &gt; New &gt; R script This will open a new screen for you to type into. Go to: File &gt; Save as and save the script file into your home directory. Now, start by setting the working directory in RStudio to the directory in which you have stored both the data and R script. One way of doing this is to go to: Session &gt; Set Working Directory &gt; To Source File Location This will point RStudio towards this directory to enable us to use files within that directory. It is useful to annotate your script file using comments so that you know what has been done when you look at it in the future. Comments can be added to a script file by starting the line with a # symbol. 1.3 Credit where credit is due The labs in S2Y incorporate and adapt materials from: Ugarte, M. D., Militino, A. F., &amp; Arnholt, A. T. (2008). Probability and Statistics with R. CRC press. The materials were converted into interactive labs on Hypothesis Testing using Bookdown and webexercises in Summer 2023 by summer project student, Megan Ruffle. "],["the-basic-premise-of-hypothsis-testing.html", "2 The Basic Premise of Hypothsis Testing 2.1 The 5 steps of Hypothesis Testing", " 2 The Basic Premise of Hypothsis Testing All hypothesis tests that we will look at in these labs will fit the same pattern: We want to decide if the observed data from our study provides evidence to reject a baseline assumption (a null hypothesis). For all tests, we will compare our observed data to an expected distribution from the null hypothesis. The values used in this comparison: The test will have a significance level and we find the critical value that corresponds to this to decide on a Rejection Region (shown in red on the graph below). This is the part of our distribution that we decide is unusual and could disprove our null hypothesis. We calculate a Standardised Test Statistic from our data and find its corresponding area on the distribution, the \\(p\\)-value, to be able to compare what we saw to the distribution (illustrated in blue on the graph below). How the Standardised Test Statistic compares to the rejection region, and hence how our \\(p\\)-value compares to the significance level, is what changes the conclusion of our hypothesis test. The graphical example above is a test that would assume normally distributed data and would result in failing to reject the null hypothesis. The red area is our rejection region. The blue area represents the probability of seeing our observed data assuming the null hypothesis is true (this probability is known as the \\(p\\)-value). The Standardised Test Statistic does not sit in the rejection region. As a result the blue area is greater than the red area meaning our data was not unusual compared to the distribution where the null hypothesis is true. 2.1 The 5 steps of Hypothesis Testing In the next few labs we will look through different scenarios where we might conduct a hypothesis test. In your textbook and lectures you have seen these tests broken into 5 steps. Often when undertaking hypothesis tests in R, we find the Standardised Test Statistic and $p$4-value in one action such as when using t.test(). In the labs the 5 steps will therefore be arranged as follows: Hypotheses Set up the null and alternative hypotheses to answer your question Test Statistic Selection Choose your Test Statistic Hypothesis Test Calculations Find the Critical Value and Rejection Region from the distribution Calculate the Standardised Test Statistic from the observed data Find the \\(p\\)-value that corresponds to the Standardised Test Statistic Statistical Conclusion Comparing the observed value of the Standardised Test Statistic to the Rejection Region or Critical value Comparing the \\(p\\)-value to the significance level English Conclusion Giving the meaning of statistical conclusion in context of the question. (Note this is slightly different to the the wording in the textbook just for simplicity of grouping together all calculations in R within Step 3.) We shall consistently find the Rejection Region and then analyse our observed data to compare it to that region. "],["example-1-the-5-steps-of-hypothesis-testing.html", "3 Example 1: The 5 Steps of Hypothesis Testing 3.1 Verifying normality 3.2 Step 1 - Hypotheses 3.3 Step 2 - Choosing a Test Statistic 3.4 Step 3 - Hypothesis Test Calculations 3.5 Step 4 - Statistical Conclusion 3.6 Step 5 - English Conclusion", " 3 Example 1: The 5 Steps of Hypothesis Testing An experiment was conducted to investigate how the resistance of rubber to abrasion is affected by the hardness of the rubber and its tensile strength. The data come from Hand et al. (1994, Data Set #6, Abrasion Loss) and are stored in the data frame Rubber of the MASS package. The abrasion loss is measured in grams/hour; the hardness, in degrees shore; and the tensile strength, in \\(kg/cm^2\\). Use the five-step procedure to test whether \\(\\mu &lt; 170\\) for abrasion loss (loss) with 95% confidence. To open this data file, type: library(MASS) RUBBER&lt;- Rubber This will assign the data to the object RUBBER. To view the data, type RUBBER into the script file and running that line by either placing the cursor on the line and pressing Ctrl and Enter, or by clicking on the Run button in the top-right corner of the script file. The data will then appear in the Console window below. A spreadsheet of the data can be viewed by typing: fix(RUBBER) but note that you will need to close this window before trying to excute any further commands. The spreadsheet can also be viewed by clicking on the RUBBER object in the Environment (top right of the screen). 3.1 Verifying normality To solve this problem, start by verifying the normality assumption of the data using exploratory data analysis (EDA()). library(PASWR) with(data = RUBBER, EDA(loss)) ## Size (n) Missing Minimum 1st Qu Mean Median TrMean 3rd Qu ## 30.000 0.000 32.000 113.250 175.433 165.000 173.536 220.500 ## Max Stdev Var SE Mean I.Q.R. Range Kurtosis Skewness ## 372.000 88.085 7759.013 16.082 107.250 340.000 -0.522 0.433 ## SW p-val ## 0.505 Based on the graphical output from the function eda(), it is not unreasonable to assume that abrasion loss follows a normal distribution. Now, proceed with the five-step procedure. 3.2 Step 1 - Hypotheses To test if mean abrasion loss is less than \\(170\\), the hypotheses are: \\[H_0 : \\mu = 170 \\quad \\text{verses} \\quad H_1 : \\mu &lt; 170\\] Learn More This is a one-tail test as as we want to know how different the loss is from a mean of 170 (specifically less than) rather than just if it is different which would give the two-tail hypotheses \\(H_0 : \\mu = 170\\) versus \\(H_1 : \\mu \\neq 170\\). 3.3 Step 2 - Choosing a Test Statistic The test statistic chosen is \\(\\bar{X}\\) because \\(E[\\bar{X}] = \\mu\\). xbar &lt;- mean(RUBBER$loss) xbar ## [1] 175.4333 The value of this test statistic is \\(\\bar{x} = \\frac{\\sum^n_{i=1}x_i}{n} = 175.4333\\) Learn More We have this as our test statistic because we want to evaluate the mean value. We will determine the probability of obtaining that test statistic (sample mean) when the null hypothesis is true. We do this with standardisation and the probability is called the \\(p\\)-value which we will find soon. The standardised test statistic under the assumption that \\(H_0\\) is true is distributed \\(\\frac{\\bar{X}−\\mu_0}{S/\\sqrt{n}} \\sim t_{30-1}\\). 3.4 Step 3 - Hypothesis Test Calculations 3.4.1 Finding the Rejection Region Because the standardised test statistic is distributed \\(t_{29}\\) and \\(H_1\\) is a lower one-sided hypothesis, the rejection region is the \\(t_{obs} \\leq t_{0.05; 29}\\). From the statistical tables, the \\(t\\)-value that corresponds to our significance level (critical value) is \\(t_{0.05; 29} = −1.6991\\). Remember this is negative because we are discussing the lower tail of the \\(t\\)-distribution. This same \\(t\\)-value can be found using R: RR &lt;- qt(0.05, df = 29) RR ## [1] -1.699127 Graphically the rejection region is as follows: Learn More The rejection region is the area in which we would reject our null hypothesis. The critical value is the \\(t\\)-value that corresponds to \\(p=0.05\\), and hence is the top limit of our rejection region. The probability of observing our test statistic (sample mean) or more extreme values under the null hypothesis is the \\(p\\)-value. To reject the null hypothesis in this case we need our standardisd test statistic to be less than our critical value and hence our \\(p\\)-value &lt; 0.05 3.4.2 Finding the standardised test statistic and \\(p\\)-value The value of the standardised test statistic is given by \\(\\frac{\\bar{X}−\\mu_0}{S/\\sqrt{n}} = \\frac{175.4333−170}{S/\\sqrt{n}}\\). We can obtain \\(S\\) and \\(n\\) in R by using: S &lt;- sd(RUBBER$loss) S ## [1] 88.08526 n &lt;- length(RUBBER$loss) n ## [1] 30 This gives our standardised test statistic \\(t_{obs}=\\frac{\\bar{X}−\\mu_0}{S/\\sqrt{n}} = 0.3378\\): sta.test.stat &lt;- (175.4333-170)/(S/sqrt(n)) sta.test.stat ## [1] 0.3378478 The \\(p\\)-value that corresponds to our standardised test statistic, \\(P(t_{29} \\leq 0.3378)\\) is: pvalue &lt;- pt(0.3378478, df=29) pvalue ## [1] 0.6310443 OR The standardised test statistic can be found using: Test &lt;- t.test(RUBBER$loss, mu = 170, alternative = &quot;less&quot;) Test ## ## One Sample t-test ## ## data: RUBBER$loss ## t = 0.33785, df = 29, p-value = 0.631 ## alternative hypothesis: true mean is less than 170 ## 95 percent confidence interval: ## -Inf 202.7589 ## sample estimates: ## mean of x ## 175.4333 Learn More Graphically this could be shown: Our standardised test statistic is greater than the critical value and outside the rejection region. The \\(p\\)-value is greater than \\(\\alpha\\). 3.5 Step 4 - Statistical Conclusion To draw conclusions we need to consider the rejection region: Is the value of standardised test statistic inside the rejection region? Is the \\(p\\)-value smaller than 0.05? QUESTION: Do we reject the null hypothesis? Solution I. From the rejection region, we fail to reject \\(H_0\\) because the standardised test statistic is greater than the critical value and hence outside the rejection region i.e. \\(t_{obs} = 0.3378 &gt; -1.6991\\). OR From the \\(p\\)-value, we fail to reject \\(H_0\\) because the \\(p\\)-value is \\(0.631 &gt; 0.05\\). Whichever method we use, we fail to reject \\(H_0\\). 3.6 Step 5 - English Conclusion What does the above statistical conclusion mean for the data and the purpose of the test? Is there statistical evidence to suggest a mean less than 170? QUESTION: Which of the following is the correct conclusion of our test? There is sufficient evidence to suggest the mean abrasion loss is less than 170. We cannot conclude if there is sufficient evidence to suggest the mean abrasion loss is less than 170. There is not sufficient evidence to suggest the mean abrasion loss is less than 170. There is sufficient evidence to suggest the mean abrasion loss is greater than 170. "],["example-2-power-of-a-test.html", "4 Example 2: Power of a test 4.1 Question 1 4.2 Question 2 4.3 Question 3 4.4 Question 4", " 4 Example 2: Power of a test A cell phone provider has estimated that it needs revenues of €2 million per day in order to make a profit and remain in the market. If revenues are less than €2 million per day, the company will go bankrupt. Likewise, revenues greater than €2 million per day cannot be handled without increasing staff. Assume that revenues follow a normal distribution with \\(\\sigma =\\) €0.5 million and a mean of \\(\\mu\\). To find out more about their revenue they want to perform a hypothesis test \\(H_0 : \\mu = 2\\) versus \\(H_1 : \\mu \\neq 2\\). To understand more about how hypothesis tests work, three scenarios will be presented to show how the power of a test can change: varying \\(\\mu\\), varying significance level and varying sample size. The power function is: \\[\\text{Power}(\\theta) = P(\\text{reject }H_0|H_0 \\text{ is false}) = P(\\text{accept }H_1|H_1) = 1-\\beta(\\theta)\\] where \\(\\beta(\\theta)\\) is the probability of a type II error at a given \\(\\theta\\). 4.1 Question 1 Graphically depict the power function for testing \\(H_0 : \\mu = 2\\) versus \\(H_1 : \\mu \\neq 2\\) if \\(n = 150\\) and \\(\\alpha = 0.05\\) for values of \\(\\mu\\) ranging from 1.8 to 2.2. First, think about whether we are doing a one or two-tailed test and what values represent rejecting or no-rejecting the null hypothesis. Next, create a vector of the values of \\(\\mu\\). Subsequently, find the critical values for the chosen significance level \\(\\alpha\\), which will be used to calculate the power for each \\(\\mu\\). The power values could be saved into a data frame to make the plotting easier. mu &lt;- seq(from = 1.8, to = 2.2, length = 500) n &lt;- 150 alpha &lt;- 0.05 sigma &lt;- 0.5 lcv &lt;- qnorm(alpha/2, 2, sigma/sqrt(n)) ucv &lt;- qnorm(1 - alpha/2, 2, sigma/sqrt(n)) Power &lt;- pnorm(lcv, mu, sigma/sqrt(n)) + pnorm(ucv, mu, sigma/sqrt(n), lower = FALSE) DF &lt;- data.frame(mu, Power) Once we have values for how the power function changes with \\(\\mu\\), we could use ggplot to create the graph: ggplot(data = DF, aes(x = mu, y = Power)) + geom_line(color = &quot;red&quot;) + theme_bw() + labs(x = expression(mu), y = expression(Power~(mu))) + geom_hline(yintercept = 0.05, color = &quot;blue&quot;, lty = &quot;dashed&quot;) 4.2 Question 2 Graphically depict the power function for testing \\(H_0 : \\mu = 2\\) versus \\(H_1 : \\mu \\neq 2\\) when \\(\\mu_1 = 2.1\\) and \\(n = 150\\) for values of \\(\\alpha\\) ranging from 0.001 to 0.999. Hint 1 Think about whether you are doing a one or two-tailed test and what values represent rejecting or no-rejecting the null hypothesis. Hint 2 First create a vector of values of \\(\\alpha\\). Then you will need to find the critical values for each \\(\\alpha\\) which will be used to calculate the corresponding test powers. The power values could be saved into a data frame to make the plotting easier. Calculations Solution alpha &lt;- seq(from = 0.001, to = 0.999, length = 500) mu &lt;- 2.1 sigma &lt;- 0.5 n &lt;- 150 lcv &lt;- qnorm(alpha/2, 2, sigma/sqrt(n)) ucv &lt;- qnorm(1 - alpha/2, 2, sigma/sqrt(n)) Power &lt;- pnorm(lcv, mu, sigma/sqrt(n)) + pnorm(ucv, mu, sigma/sqrt(n), lower = FALSE) DF &lt;- data.frame(mu, Power) Plot Solution ggplot(data = DF, aes(x = alpha, y = Power)) + geom_line(color = &quot;red&quot;) + theme_bw() + labs(x = expression(alpha), y = expression(Power~(alpha))) + geom_hline(yintercept = 0.05, color = &quot;blue&quot;, lty = &quot;dashed&quot;) 4.3 Question 3 Graphically depict the power for testing \\(H_0 : \\mu = 2\\) versus \\(H_1 : \\mu \\neq 2\\) when \\(\\mu_1 = 2.1\\) and \\(\\alpha = 0.05\\) for values of \\(n\\) ranging from 1 to 500. Hint Create a vector of values of \\(n\\) and then find the critical values for each \\(n\\) which will be used to calculate the corresponding test powers. Calculations Solution n &lt;- 1:500 mu &lt;- 2.1 sigma &lt;- 0.5 alpha &lt;- 0.05 lcv &lt;- qnorm(alpha/2, 2, sigma/sqrt(n)) ucv &lt;- qnorm(1 - alpha/2, 2, sigma/sqrt(n)) Power &lt;- pnorm(lcv, mu, sigma/sqrt(n)) + pnorm(ucv, mu, sigma/sqrt(n), lower = FALSE) DF &lt;- data.frame(mu, Power) Plot Solution ggplot(data = DF, aes(x = n, y = Power)) + geom_line(color = &quot;red&quot;) + theme_bw() + labs(x = expression(n), y = expression(Power~(n))) + geom_hline(yintercept = 0.05, color = &quot;blue&quot;, lty = &quot;dashed&quot;) 4.4 Question 4 Think about each scenario above and select the correct statements below: Scenario 1 - Varying mean For a fixed value of n and significance level alpha, the power of a test increases as the true mean moves closer from the hypothesized mean. For a fixed value of n and significance level alpha, the power of a test decreases as the true mean moves farther from the hypothesized mean. For a fixed value of n and significance level alpha, the power of a test increases as the true mean moves farther from the hypothesized mean. Scenario 2 - Varying significance level \\(\\alpha\\) When the sample size is fixed, the power of a test increases as alpha increases. When the sample size is fixed, the power of a test decreases as alpha increases. Scenario 3 - Varying sample size \\(n\\) When the significance level of the test is fixed, the power of the test increases as the sample size increases. When the significance level of the test is fixed, the power of the test decreases as the sample size increases. "],["exercise-1-plant-height-hypothesis-test.html", "5 Exercise 1: Plant Height Hypothesis Test", " 5 Exercise 1: Plant Height Hypothesis Test Using the data frame Fertilize in the package PASWR, which contains the height in inches for plants for cross fertilization and self-fertilization, test if the data suggest that the average height of self-fertilized plants is more than 17 inches. Use \\(\\alpha = 0.05\\). a) Does this data fit the required assumption of normality to perform a hypothesis test? Solution We can verify the normality assumption of the data using exploratory data analysis (EDA()). library(PASWR) FERTILIZE &lt;- Fertilize EDA(FERTILIZE$self) ## Size (n) Missing Minimum 1st Qu Mean Median TrMean 3rd Qu ## 15.000 0.000 12.750 16.375 17.575 18.000 17.575 18.625 ## Max Stdev Var SE Mean I.Q.R. Range Kurtosis Skewness ## 20.375 2.052 4.209 0.530 2.250 7.625 -0.262 -0.647 ## SW p-val ## 0.377 The results from applying the function EDA() to self fertilized plants suggest it is not unreasonable to assume that plant height for self fertilized plants follows a normal distribution. Now, proceed with the five-step procedure. b) Step 1 - select the correct hypothesis: What are the null and alternative hypotheses for this problem? \\[\\begin{align} 1&amp;. \\quad H_0 : \\mu = 17 \\quad \\text{versus} \\quad H_1 : \\mu &lt; 17\\\\ O&amp;R\\\\ 2&amp;. \\quad H_0 : \\mu = 17 \\quad \\text{versus} \\quad H_1 : \\mu &gt; 17 \\\\ O&amp;R\\\\ 3&amp;. \\quad H_0 : \\mu = 17 \\quad \\text{versus} \\quad H_1 : \\mu \\neq 17 \\end{align}\\] 123 c) Step 2 - Choose and calculate the test statistic (before standardisation). The test statistic \\(\\bar{X}=\\) Solution The test statistic chosen is \\(\\bar{X}\\) because \\(E[\\bar{X}] = \\mu\\). xbar &lt;- mean(FERTILIZE$self) xbar ## [1] 17.575 The value of this test statistic is \\(\\bar{x} = \\frac{\\sum^n_{i=1}x_i}{n} = 17.575\\) d) Step 3a - Finding rejection region \\(t_{obs} &gt; t_{1-0.05; df}\\). Find the degrees of freedom. Find the critical value \\(t_{1-0.05; df} =\\) Solution As the sample size is 15, the standardised test statistic is distributed \\(t_{14}\\). Moreover, since \\(H_1\\) is an upper one-sided hypothesis, the rejection region is the \\(t_{obs} &gt; t_{1-0.05; 14} = t_{0.95; 14}.\\) From the statistical table, the \\(t\\)-value that corresponds to the chosen significance level (i.e., the critical value) is \\(t_{0.95; 14} = 1.7613\\). Remember this is positive because we are discussing the upper tail of the \\(t\\)-distribution. This same \\(t\\)-value can be found in R by using: RR &lt;- qt(0.95, df = 14) RR ## [1] 1.76131 e) Step 3b - Finding the standardised test statistic and \\(p\\)-value for our data. Calculate the value of the standardisied test statistic. Calculate the \\(p\\)-value that corresponds to our standardised test statistic. Hint The standardised test statistic under the assumption that \\(H_0\\) is true and its distribution are \\(\\frac{\\bar{X}−\\mu_0}{S/\\sqrt{n}} \\sim t_{df}\\). Solution Our standardised test statistic is given by \\(\\frac{\\bar{X}−\\mu_0}{S/\\sqrt{n}} = \\frac{17.575−17}{S/\\sqrt{n}}\\). The standard deviation \\(S\\) and the sample size \\(n\\) can be obtained in R by using: S &lt;- sd(FERTILIZE$self) S ## [1] 2.051676 n &lt;- length(FERTILIZE$self) n ## [1] 15 This gives the value of our standardised test statistic \\(t_{obs}=\\frac{\\bar{X}−\\mu_0}{S/\\sqrt{n}} = 1.0854\\): sta.test.stat &lt;- (17.575-17)/(S/sqrt(n)) sta.test.stat ## [1] 1.085437 OR The standardised test statistic can be found using: Test &lt;- t.test(FERTILIZE$self, mu = 17, alternative = &quot;greater&quot;) Test ## ## One Sample t-test ## ## data: FERTILIZE$self ## t = 1.0854, df = 14, p-value = 0.148 ## alternative hypothesis: true mean is greater than 17 ## 95 percent confidence interval: ## 16.64196 Inf ## sample estimates: ## mean of x ## 17.575 pvalue &lt;- 1-pt(1.085437, df=14) pvalue ## [1] 0.1480328 Graphically this could be shown: The value of our standardised test statistic is greater than the critical value and outside the rejection region. The \\(p\\)-value is greater than \\(\\alpha\\) OR The \\(p\\)-value can be found using: Test &lt;- t.test(FERTILIZE$self, mu = 17, alternative = &quot;greater&quot;) Test ## ## One Sample t-test ## ## data: FERTILIZE$self ## t = 1.0854, df = 14, p-value = 0.148 ## alternative hypothesis: true mean is greater than 17 ## 95 percent confidence interval: ## 16.64196 Inf ## sample estimates: ## mean of x ## 17.575 f) Step 4 - Statistical Conclusion Do we reject our null hypothesis? Solution I. From the rejection region, we fail to reject \\(H_0\\) because the standardised test statistic is less than the critical value and hence outside the rejection region i.e \\(t_{obs} = 1.0854 &lt; 1.7613\\). OR From the \\(p\\)-value, we fail to reject \\(H_0\\) because the \\(p\\)-value is \\(0.1480 &gt; 0.05\\). Whichever method we use, we fail to reject \\(H_0\\). g) Step 5 - English Conclusion Is there statistical evidence to suggest a mean greater than 17? There is sufficient evidence to suggest the average height of self-fertilized plants is more than 17 inches We cannot conclude if there is sufficient evidence to suggest the average height of self-fertilized plants is more than 17 inches. There is not sufficient evidence to suggest the the average height of self-fertilized plants is more than 17 inches. There is sufficient evidence to suggest the average height of self-fertilized plants is less than 17 inches. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
