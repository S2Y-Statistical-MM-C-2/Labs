<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Example 1 (Part 1): Crime | Lab 5 - Ordinary Least Squares</title>
  <meta name="description" content="2 Example 1 (Part 1): Crime | Lab 5 - Ordinary Least Squares" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Example 1 (Part 1): Crime | Lab 5 - Ordinary Least Squares" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Example 1 (Part 1): Crime | Lab 5 - Ordinary Least Squares" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="example-1-part-2-change-to-example.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to Lab 5!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction-to-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>1.1</b> Introduction to Ordinary Least Squares (OLS)</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-simplest-regression-model-simple-linear-regression-one-covariate"><i class="fa fa-check"></i><b>1.2</b> The simplest regression model: Simple Linear Regression (one covariate)</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-next-simplest-regression-model-multiple-linear-regression-multiple-covariates"><i class="fa fa-check"></i><b>1.3</b> The next-simplest regression model: Multiple Linear Regression (multiple covariates)</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#ordinary-least-squares"><i class="fa fa-check"></i><b>1.4</b> Ordinary Least Squares</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#credit-where-credit-is-due"><i class="fa fa-check"></i><b>1.5</b> Credit where credit is due</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-1-part-1-crime.html"><a href="example-1-part-1-crime.html"><i class="fa fa-check"></i><b>2</b> Example 1 (Part 1): Crime</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-1-part-1-crime.html"><a href="example-1-part-1-crime.html#least-squares-estimates-of-model-parameters-using-vector-matrix-form"><i class="fa fa-check"></i><b>2.1</b> Least squares estimates of model parameters using vector-matrix form</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-1-part-2-change-to-example.html"><a href="example-1-part-2-change-to-example.html"><i class="fa fa-check"></i><b>3</b> Example 1 (Part 2): change to example</a></li>
<li class="chapter" data-level="4" data-path="exercise-1-slr-with-no-intercept.html"><a href="exercise-1-slr-with-no-intercept.html"><i class="fa fa-check"></i><b>4</b> Exercise 1: SLR with no intercept</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exercise-1-slr-with-no-intercept.html"><a href="exercise-1-slr-with-no-intercept.html#fitting-a-linear-model-with-no-intercept"><i class="fa fa-check"></i><b>4.1</b> Fitting a linear model with no intercept</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercise-2-quadratic-regression.html"><a href="exercise-2-quadratic-regression.html"><i class="fa fa-check"></i><b>5</b> Exercise 2: Quadratic regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exercise-2-quadratic-regression.html"><a href="exercise-2-quadratic-regression.html#fitting-a-quadratic-regression-model"><i class="fa fa-check"></i><b>5.1</b> Fitting a quadratic regression model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exercise-3-the-taste-of-cheese.html"><a href="exercise-3-the-taste-of-cheese.html"><i class="fa fa-check"></i><b>6</b> Exercise 3: The taste of cheese</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exercise-3-the-taste-of-cheese.html"><a href="exercise-3-the-taste-of-cheese.html#exploratory-analysis-2"><i class="fa fa-check"></i><b>6.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="6.2" data-path="exercise-3-the-taste-of-cheese.html"><a href="exercise-3-the-taste-of-cheese.html#fitting-a-model"><i class="fa fa-check"></i><b>6.2</b> Fitting a model</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab 5 - Ordinary Least Squares</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-1-part-1-crime" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Example 1 (Part 1): Crime<a href="example-1-part-1-crime.html#example-1-part-1-crime" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We briefly looked at this data in the lectures. Here 50 US states were investigated in terms of their crime rates (per 100,000 people), which includes crimes such as murder, assault, and car theft. Some demographic information about each state was also recorded, such as the number of police and prisoners per 100,000 people, the percentage of population living in poverty, and the percentage of high school dropouts (i.e. 16-19 year olds who were not in school and did not finish the 12<span class="math inline">\(^\text{th}\)</span> grade). The question of interest is whether we can predict US crime rates from the high school dropout rates and other predictors?</p>
<p>The data are available from the csv file <code>crime.csv</code> and contain six columns, described as follows:</p>
<table>
<thead>
<tr class="header">
<th align="left">C1</th>
<th align="left">C1.T</th>
<th align="left">US state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>C2</strong></td>
<td align="left"><strong>Crime</strong></td>
<td align="left"><strong>Crime rate per 100,000</strong></td>
</tr>
<tr class="even">
<td align="left"><strong>C3</strong></td>
<td align="left"><strong>Police</strong></td>
<td align="left"><strong>Number of police per 100,000</strong></td>
</tr>
<tr class="odd">
<td align="left"><strong>C4</strong></td>
<td align="left"><strong>Prison</strong></td>
<td align="left"><strong>Number of prisoners per 100,000</strong></td>
</tr>
<tr class="even">
<td align="left"><strong>C5</strong></td>
<td align="left"><strong>Poverty</strong></td>
<td align="left"><strong>Percentage of population living in poverty</strong></td>
</tr>
<tr class="odd">
<td align="left"><strong>C6</strong></td>
<td align="left"><strong>Dropout</strong></td>
<td align="left"><strong>Percentage of high school dropouts</strong></td>
</tr>
</tbody>
</table>
<p><br>
<strong>Part 1: Simple Linear Regression</strong>:</p>
<ol style="list-style-type: lower-alpha">
<li>Use <code>plot</code> or <code>pairs</code> to visualise the data and determine which predictors may be useful in predicting <code>Crime</code>.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>The <code>R</code> command <code>pairs()</code> may be used to see the relationships between all variables.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="example-1-part-1-crime.html#cb1-1" tabindex="-1"></a>crime <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;crime.csv&quot;</span>)</span>
<span id="cb1-2"><a href="example-1-part-1-crime.html#cb1-2" tabindex="-1"></a><span class="fu">pairs</span>(crime[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">lower.panel =</span> <span class="cn">NULL</span>) <span class="co"># We add [,-1] to the end of crime to remove the first column which has non-numeric arguments (state names)</span></span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-2-1.png" width="672" />
</p>
<p>Apart from Dropout which has been discussed in the lectures, there may also be a positive linear relationship between <code>Crime</code> and <code>Police</code> and between <code>Crime</code> and <code>Prison</code>, though the relationship doesn't seem to be very strong.</p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Build a simple linear regression model with <code>Dropout</code> as the predictor and interpret estimated coefficients.</li>
</ol>
<p>According to the model, when Dropout is equal to 0, the crime rate would be roughly <input class='webex-solveme nospaces' size='9' data-answer='["2196.5435","2196.544","2196.54","2196.5","2197"]'/>.
For every 1% increase in the % of high school dropouts, the expected crime rate (per 100,000) would <select class='webex-select'><option value='blank'></option><option value='answer'>increase</option><option value=''>decrease</option></select> by <input class='webex-solveme nospaces' size='8' data-answer='["281.7613","281.761","281.76","281.8","282"]'/>.</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>Use <code>lm</code> to build a linear regression model and <code>summary()</code> to find the coefficients.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="example-1-part-1-crime.html#cb2-1" tabindex="-1"></a>m.crime <span class="ot">&lt;-</span> <span class="fu">lm</span>(Crime <span class="sc">~</span> Dropout, <span class="at">data =</span> crime) </span>
<span id="cb2-2"><a href="example-1-part-1-crime.html#cb2-2" tabindex="-1"></a><span class="fu">summary</span>(m.crime)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Crime ~ Dropout, data = crime)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2657.7  -698.0   158.8   653.3  2132.3 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2196.5      640.0   3.432  0.00124 ** 
## Dropout        281.8       60.8   4.634 2.77e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1024 on 48 degrees of freedom
## Multiple R-squared:  0.3091, Adjusted R-squared:  0.2947 
## F-statistic: 21.47 on 1 and 48 DF,  p-value: 2.77e-05</code></pre>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>From the lectures we know that the least squares estimates for the model parameters are</li>
</ol>
<p><span class="math display">\[\hat{\boldsymbol \beta} = \begin{bmatrix} \hat{\beta_0} \\[0.5em] \hat{\beta_1} \end{bmatrix} = \begin{bmatrix} \overline{Y} - \hat{\beta_1} \overline{x} \\[0.5em] \frac{S_{xy}}{S_{xx}} \end{bmatrix}\]</span>
Use this formula to compute the least squares estimates for the model parameters, <span class="math inline">\(\overline{\beta_0}\)</span> and <span class="math inline">\(\overline{\beta_1}\)</span>.</p>
<center>
<span class="math inline">\(\hat{\beta}_0\)</span> = <input class='webex-solveme nospaces' size='9' data-answer='["2196.5435","2196.544","2196.54","2196.5","2197"]'/>,
<span class="math inline">\(\hat{\beta}_1\)</span> = <input class='webex-solveme nospaces' size='8' data-answer='["281.7613","281.761","281.76","281.8","282"]'/>
</center>
<div class="webex-solution">
<button>
Hint
</button>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="example-1-part-1-crime.html#cb4-1" tabindex="-1"></a>x<span class="ot">&lt;-</span>crime<span class="sc">$</span>Dropout</span>
<span id="cb4-2"><a href="example-1-part-1-crime.html#cb4-2" tabindex="-1"></a>y<span class="ot">&lt;-</span>crime<span class="sc">$</span>Crime</span>
<span id="cb4-3"><a href="example-1-part-1-crime.html#cb4-3" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb4-4"><a href="example-1-part-1-crime.html#cb4-4" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb4-5"><a href="example-1-part-1-crime.html#cb4-5" tabindex="-1"></a>S_xx <span class="ot">&lt;-</span> <span class="fu">sum</span>((x<span class="sc">-</span>x_mean)<span class="sc">^</span><span class="dv">2</span>)  </span>
<span id="cb4-6"><a href="example-1-part-1-crime.html#cb4-6" tabindex="-1"></a>S_xy <span class="ot">&lt;-</span> <span class="fu">sum</span>((x<span class="sc">-</span>x_mean)<span class="sc">*</span>(y<span class="sc">-</span>y_mean))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="example-1-part-1-crime.html#cb5-1" tabindex="-1"></a>beta1.hat <span class="ot">&lt;-</span> S_xy<span class="sc">/</span>S_xx</span>
<span id="cb5-2"><a href="example-1-part-1-crime.html#cb5-2" tabindex="-1"></a>beta0.hat <span class="ot">&lt;-</span> y_mean <span class="sc">-</span> beta1.hat<span class="sc">*</span>x_mean </span>
<span id="cb5-3"><a href="example-1-part-1-crime.html#cb5-3" tabindex="-1"></a>beta1.hat</span></code></pre></div>
<pre><code>## [1] 281.7613</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="example-1-part-1-crime.html#cb7-1" tabindex="-1"></a>beta0.hat</span></code></pre></div>
<pre><code>## [1] 2196.543</code></pre>
</div>
<div id="least-squares-estimates-of-model-parameters-using-vector-matrix-form" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Least squares estimates of model parameters using vector-matrix form<a href="example-1-part-1-crime.html#least-squares-estimates-of-model-parameters-using-vector-matrix-form" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To use the least squares vector-matrix formula given by <a href="#eq:LSE">(<strong>??</strong>)</a>, we first need to find the design matrix, <span class="math inline">\(\mathbf{X}\)</span>. This can be done using the following <code>R</code> command:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="example-1-part-1-crime.html#cb9-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Dropout, <span class="at">data =</span> crime)</span></code></pre></div>
<p>This gives us the design matrix, <span class="math inline">\(\mathbf{X}\)</span>, for the simple linear regression model in <a href="#eq:SLR">(<strong>??</strong>)</a>, where we have <span class="math inline">\(n = 50\)</span>
rows corresponding to each of the 50 US states, and <span class="math inline">\(p = 2\)</span> columns corresponding to the model parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. More generally this is written as
<span class="math display">\[\mathbf{X} =\begin{bmatrix} 1 &amp; x_1 \\1 &amp; x_2 \\ \vdots &amp; \vdots \\ 1 &amp; x_n\end{bmatrix} \]</span>
The first column of <span class="math inline">\(\mathbf{X}\)</span> contains 1's as that is the column that multiplies the first component of the parameter vector <span class="math inline">\(\boldsymbol\beta^\top = \begin{bmatrix} \beta_0 &amp; \beta_1 \end{bmatrix}\)</span>, and as can be seen from the model, the intercept term, <span class="math inline">\(\beta_0\)</span>, is constant across all <span class="math inline">\(i\)</span> observations. The slope parameter, <span class="math inline">\(\beta_1\)</span>, is also constant, however, the differences in crime rates between states comes from changes in the percentage of high school dropouts, given by <span class="math inline">\(x_i\)</span>, which multiplies <span class="math inline">\(\beta_1\)</span>. The random errors, <span class="math inline">\(\epsilon_i\)</span>, also differ per state.</p>
<p>Next we need the following commands to calculate each component in the least squares vector-matrix formula:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="example-1-part-1-crime.html#cb10-1" tabindex="-1"></a>t       <span class="co"># gets the transpose of a vector or matrix</span></span>
<span id="cb10-2"><a href="example-1-part-1-crime.html#cb10-2" tabindex="-1"></a><span class="sc">%*%</span>     <span class="co"># multiplies matrices together</span></span>
<span id="cb10-3"><a href="example-1-part-1-crime.html#cb10-3" tabindex="-1"></a>solve   <span class="co"># computes the inverse of a matrix</span></span></code></pre></div>
<p>Let's compute <span class="math inline">\(\mathbf{X}^\top\mathbf{X}\)</span> using the following <code>R</code> code:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="example-1-part-1-crime.html#cb11-1" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span></code></pre></div>
<p>This gives</p>
<p><span class="math display">\[\mathbf{X}^\top\mathbf{X} = \begin{bmatrix} 50.0 &amp; 512.6 \\ 512.6 &amp; 5538.8 \end{bmatrix}\]</span></p>
<p>Recall, if</p>
<p><span class="math display">\[\mathbf{A} = \begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix} \quad\quad \text{then} \quad\quad \mathbf{A}^{-1} = \frac{1}{\text{det}\left(\mathbf{A}\right)}\begin{bmatrix} d &amp; -b \\ -c &amp; a \end{bmatrix} = \frac{1}{ad - bc}\begin{bmatrix} d &amp; -b \\ -c &amp; a \end{bmatrix}.\]</span></p>
<p>Given <span class="math inline">\(\mathbf{X}^\top\mathbf{X}\)</span> above, compute its inverse <span class="math inline">\(\left(\mathbf{X}^\top\mathbf{X}\right)^{-1}\)</span>:
<br><br></p>
<p><span class="math display">\[(\mathbf{X}^\top\mathbf{X})^{-1} = \hspace{9em}\]</span>
<br></p>
<p>To find <span class="math inline">\(\hat{\boldsymbol\beta}\)</span> we also need to find <span class="math inline">\(\mathbf{X}^\top\mathbf{Y}\)</span>. Using the above commands, or by hand, compute <span class="math inline">\(\mathbf{X}^\top\mathbf{Y}\)</span>:
<br><br></p>
<p><span class="math display">\[\mathbf{X}^\top\mathbf{Y} = \begin{bmatrix} &amp; &amp; &amp; &amp; \\\\ \\  \end{bmatrix}\]</span>
<br></p>
<p>Multiplying <span class="math inline">\(\left(\mathbf{X}^\top\mathbf{X}\right)^{-1}\)</span> and <span class="math inline">\(\mathbf{X}^\top\mathbf{Y}\)</span> then gives us the least squares estimates of the model parameters. By hand, compute the parameter estimates, <span class="math inline">\(\hat{\boldsymbol\beta}\)</span>, such that</p>
<p><br></p>
<p><span class="math display">\[\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{Y} = \]</span></p>
<p><br>
<!-- **QUESTION 1** --></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Use the <code>R</code> commands given above to compute <span class="math inline">\(\left(\mathbf{X}^\top\mathbf{X}\right)^{-1}\)</span> and <span class="math inline">\(\mathbf{X}^\top\mathbf{Y}\)</span>, and hence <span class="math inline">\(\hat{\boldsymbol\beta}\)</span>, and compare the output with your handwritten results.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="example-1-part-1-crime.html#cb12-1" tabindex="-1"></a>XtX_inv <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX)</span>
<span id="cb12-2"><a href="example-1-part-1-crime.html#cb12-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> crime<span class="sc">$</span>Crime</span>
<span id="cb12-3"><a href="example-1-part-1-crime.html#cb12-3" tabindex="-1"></a>XtY <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> Y</span>
<span id="cb12-4"><a href="example-1-part-1-crime.html#cb12-4" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX) <span class="sc">%*%</span> XtY</span></code></pre></div>
</div>
<p><br></p>
<p>We can also obtain the vector of random errors, <span class="math inline">\(\boldsymbol \epsilon\)</span>, by taking the difference between the observed values, <span class="math inline">\(\mathbf{Y}\)</span>, and the fitted values, <span class="math inline">\(\hat{\mathbf{Y}} = \mathbf{X}\hat{\boldsymbol\beta}\)</span>, using the command:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="example-1-part-1-crime.html#cb13-1" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> Y <span class="sc">-</span> X <span class="sc">%*%</span> param.ests</span></code></pre></div>
<p>The residual sum of squares for the model can be obtained from formula <a href="#eq:sigma">(<strong>??</strong>)</a> using the following commands:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="example-1-part-1-crime.html#cb14-1" tabindex="-1"></a>YtY <span class="ot">&lt;-</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> Y</span>
<span id="cb14-2"><a href="example-1-part-1-crime.html#cb14-2" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> YtY <span class="sc">-</span> <span class="fu">t</span>(XtY) <span class="sc">%*%</span> param.ests</span></code></pre></div>
<p>Now compute the estimate of the error variance, <span class="math inline">\(\hat{\sigma}^2\)</span>:
<br></p>
<p><span class="math display">\[\hat{\sigma}^2 = \frac{\text{RSS}}{n-p} = \hspace{10em}\]</span>
<br></p>
<p>The estimate of standard deviation, i.e. <span class="math inline">\(\hat{\sigma}\)</span>, has been calculated by <code>R</code> when fitting the model, which is the <code>Residual standard error</code> produced from <code>summary(model1)</code>. This can also be seen using the following command:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="example-1-part-1-crime.html#cb15-1" tabindex="-1"></a><span class="fu">summary</span>(model1)<span class="sc">$</span>sigma</span></code></pre></div>
<p><br>
<strong>Part 2: Multiple Linear Regression</strong></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Use one or more predictors alongside <code>Dropout</code> to build a multiple linear regression model for explaining <code>Crime</code>.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Use the graph found using the <code>pairs()</code> command in (a) to select predictors that appear suitable for describing Crime.</p>
<p>Recall that a multiple linear regression model can be constructed using</p>
<center>
<code>model &lt;- lm(Crime ~ Dropout + Predictor1 + Predictor2 + ..., data = crime)</code>
</center>
</div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Calculate the least squares estimates of parameters in the new multiple linear regression model using the vector-matrix formulation.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>The same steps can be followed as in (d), but the design matrix <code>X</code> has to be updated accordingly. Say we want to add <code>Police</code> and <code>Prison</code> variables to our model. We would then use the following code.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="example-1-part-1-crime.html#cb16-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> Dropout <span class="sc">+</span> Police <span class="sc">+</span> Prison, <span class="at">data =</span> crime)</span>
<span id="cb16-2"><a href="example-1-part-1-crime.html#cb16-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> crime<span class="sc">$</span>Crime</span>
<span id="cb16-3"><a href="example-1-part-1-crime.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="example-1-part-1-crime.html#cb16-4" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb16-5"><a href="example-1-part-1-crime.html#cb16-5" tabindex="-1"></a>XtY <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> Y</span>
<span id="cb16-6"><a href="example-1-part-1-crime.html#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="example-1-part-1-crime.html#cb16-7" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX) <span class="sc">%*%</span> XtY</span>
<span id="cb16-8"><a href="example-1-part-1-crime.html#cb16-8" tabindex="-1"></a>beta.hat</span></code></pre></div>
<pre><code>##                    [,1]
## (Intercept) 1513.317509
## Dropout      148.343452
## Police         4.782505
## Prison         2.794514</code></pre>
</div>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Check Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Check Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-1-part-2-change-to-example.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
